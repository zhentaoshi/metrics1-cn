
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8. 假设检验 &#8212; 计量经济学讲义</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="9. 面板数据" href="lecture9-CN.html" />
    <link rel="prev" title="7. 最小二乘法:渐近性质" href="lecture6-CN.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="zh_CN">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">计量经济学讲义</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    前言
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lecture1-CN.html">
   1. 概率
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture2-CN.html">
   2. 回归、投影和因果关系
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture3-CN.html">
   3. 最小二乘法:线性代数观点
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture4-CN.html">
   4. 最小二乘法:有限样本理论
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="real-data.html">
   5. 数据实例
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture5-CN.html">
   6. 基本渐近理论
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture6-CN.html">
   7. 最小二乘法:渐近性质
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   8. 假设检验
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture9-CN.html">
   9. 面板数据
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture10-CN.html">
   10. 内生性
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture11-CN.html">
   11. 广义矩估计
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibfile_place.html">
   12. 参考文献
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/zhentaoshi/metrics1-cn/master?urlpath=tree/docs/lecture8-CN.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/zhentaoshi/metrics1-cn"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/zhentaoshi/metrics1-cn/issues/new?title=Issue%20on%20page%20%2Flecture8-CN.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/lecture8-CN.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   8.1. 检验
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     8.1.1. 决策规则与误差
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   8.2. 最优性
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wilks">
   8.3. 似然比检验与Wilks定理
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#score-test">
     8.3.1. Score Test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   8.4. 置信区间
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   8.5. 贝叶斯可信集
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   8.6. 线性回归中的应用
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wald">
     8.6.1. Wald检验
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     8.6.2. 拉格朗日乘数检验
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     8.6.3. 似然比检验
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   8.7. 总结
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>假设检验</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   8.1. 检验
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     8.1.1. 决策规则与误差
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   8.2. 最优性
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wilks">
   8.3. 似然比检验与Wilks定理
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#score-test">
     8.3.1. Score Test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   8.4. 置信区间
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   8.5. 贝叶斯可信集
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   8.6. 线性回归中的应用
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wald">
     8.6.1. Wald检验
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     8.6.2. 拉格朗日乘数检验
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     8.6.3. 似然比检验
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   8.7. 总结
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">8. </span>假设检验<a class="headerlink" href="#id1" title="永久链接至标题">#</a></h1>
<p>数学标记: <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> 是一个随机变量, 或随机向量； <span class="math notranslate nohighlight">\( \mathbf{x} \)</span> 是其实现值。</p>
<p>一个 <strong>假设(hypothesis)</strong> 是关于参数空间 <span class="math notranslate nohighlight">\( \Theta \)</span> 的陈述。</p>
<p>假设检验检查数据是否满足<strong>零假设(null hypothesis)</strong><span class="math notranslate nohighlight">\(\Theta_{0}\)</span>。<span class="math notranslate nohighlight">\(\Theta_{0}\)</span> 是 <span class="math notranslate nohighlight">\( \Theta \)</span> 中研究者感兴趣的部分；它是 <span class="math notranslate nohighlight">\( \Theta \)</span> 的子集。理想情况下, 这一零假设应该是由科学理论提出的。<strong>备择假设(alternative hypothesis)</strong> <span class="math notranslate nohighlight">\(\Theta_{1}=\Theta\backslash\Theta_{0}\)</span> 是 <span class="math notranslate nohighlight">\( \Theta_{0}\)</span> 的补集。
基于观察到的数据, 我们选择接受或者拒绝零假设。如果零假设被拒绝, 则意味着从统计学角度来看, 数据与所提出的科学假说不相容。</p>
<p>在本章中，我们首先介绍假设检验的思想与实践，以及与之相关的置信区间。虽然我们主要以频率学派的观点理解假设检验，我们也简要地讨论贝叶斯学派的统计决策方法。另外，我们也引入假设检验在线性回归中的应用——如何在有限制与无限制的情况下，对(非)线性回归中的参数值进行假设检验。</p>
<section id="id2">
<h2><span class="section-number">8.1. </span>检验<a class="headerlink" href="#id2" title="永久链接至标题">#</a></h2>
<section id="id3">
<h3><span class="section-number">8.1.1. </span>决策规则与误差<a class="headerlink" href="#id3" title="永久链接至标题">#</a></h3>
<p>如果 <span class="math notranslate nohighlight">\(\Theta_{0}\)</span> 是单点集合, 我们称之为<strong>简单假设</strong>；否则, 我们称其为<strong>复合假设</strong>。例如，若参数空间 <span class="math notranslate nohighlight">\(\Theta=\mathbb{R}\)</span> , 则 <span class="math notranslate nohighlight">\( \Theta_{0}=\left\{ 0\right\}\)</span>(或等价于 <span class="math notranslate nohighlight">\(\Theta_{0}=0\)</span> ) 是一个简单假设，而 <span class="math notranslate nohighlight">\(\Theta_{0}=(-\infty, 0]\)</span>(或者等价于 <span class="math notranslate nohighlight">\( \theta_{0}\leq0 \)</span> ) 是一个复合假设。</p>
<p><strong>检验函数(test function)</strong> 是一个映射</p>
<div class="math notranslate nohighlight">
\[ 
\phi: \mathcal{X}^{n}\mapsto\left\{ 0, 1\right\} , 
\]</div>
<p>其中, <span class="math notranslate nohighlight">\(\mathcal{X}\)</span> 是样本空间。若 <span class="math notranslate nohighlight">\(\phi\left(\mathbf{x}\right) =0\)</span> , 则接受零假设；若 <span class="math notranslate nohighlight">\( \phi\left(\mathbf{x}\right) =1 \)</span> , 则拒绝零假设。</p>
<p>我们定义 <strong>接受域(acceptance region)</strong> 为 <span class="math notranslate nohighlight">\( A_{\phi}=\left\{ \mathbf{x}\in\mathcal{X}^{n}: \phi_{\theta}\left(\mathbf{x}\right) =0\right\} \)</span> , 其补集 <span class="math notranslate nohighlight">\( R_{\phi}=\left\{ \mathbf{x}\in\mathcal{X}^{n}: \phi\left(\mathbf{x}\right) =1\right\} \)</span> 称为<strong>拒绝域(rejection region)</strong>。</p>
<p>检验 <span class="math notranslate nohighlight">\( \phi \)</span> <strong>的功效函数(power function)</strong> 被定义为</p>
<div class="math notranslate nohighlight">
\[ 
\beta\left(\theta\right) =P_{\theta}\left\{ \phi\left(\mathbf{X}\right) =1\right\} =E_{\theta}\left[\phi\left(\mathbf{X}\right) \right].
 \]</div>
<p>功效函数衡量的是当数据由真实参数 <span class="math notranslate nohighlight">\(\theta\)</span> 产生时，检验函数拒绝零假设的概率。上式中 <span class="math notranslate nohighlight">\(P_{\theta}\)</span> 与 <span class="math notranslate nohighlight">\(E_{\theta}\)</span> 体现了功效函数依赖于真实参数 <span class="math notranslate nohighlight">\(\theta_0\)</span>。</p>
<p>对于某参数值 <span class="math notranslate nohighlight">\(\theta\in\Theta_{1}\)</span> 检验的<strong>功效(power)</strong> 被定义为 <span class="math notranslate nohighlight">\( \beta\left(\theta\right) \)</span> ，检验的 <strong>尺度(size)</strong> 被定义为 <span class="math notranslate nohighlight">\( \sup_{\theta\in\Theta_{0}}\beta\left(\theta\right)\)</span> 。</p>
<p>注意, 检验功效的定义取决于备择假设 <span class="math notranslate nohighlight">\( \Theta_{1} \)</span> 中的 <span class="math notranslate nohighlight">\( \theta \)</span> ；而检验尺度的定义与具体的 <span class="math notranslate nohighlight">\( \theta \)</span> 值无关, 因为它是零假设 <span class="math notranslate nohighlight">\( \Theta_{0} \)</span> 的上确界。当难以推导出精确的上确界时, 我们也常用<strong>水平(level)</strong> <span class="math notranslate nohighlight">\( \alpha \)</span> 这一概念来衡量检验, 水平 <span class="math notranslate nohighlight">\( \alpha\in\left(0, 1\right) \)</span> 是任意使得 <span class="math notranslate nohighlight">\( \alpha\geq\sup_{\theta\in\Theta_{0}}\beta\left(\theta\right) \)</span> 成立的值。</p>
<p>一个尺度为 <span class="math notranslate nohighlight">\( \alpha \)</span> 的检验, 其水平一定大于等于 <span class="math notranslate nohighlight">\( \alpha \)</span> ；一个水平为 <span class="math notranslate nohighlight">\( \alpha \)</span> 的检验，其尺度一定小于等于 <span class="math notranslate nohighlight">\( \alpha \)</span> 。</p>
<table class="colwidths-auto table" id="mytable">
<caption><span class="caption-number">表 8.1 </span><span class="caption-text">表格8.1</span><a class="headerlink" href="#mytable" title="永久链接至表格">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>accept <span class="math notranslate nohighlight">\( H_{0} \)</span></p></th>
<th class="head"><p>reject <span class="math notranslate nohighlight">\( H_{0} \)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\( H_{0} \)</span> true</p></td>
<td><p>correct decision</p></td>
<td><p>Type I error</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\( H_{0} \)</span> false</p></td>
<td><p>Type II error</p></td>
<td><p>correct decision</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>犯 <strong>第一类错误(Type I error)</strong> 的 <strong>概率</strong> 为
<span class="math notranslate nohighlight">\( \beta\left(\theta\right) \)</span> , 其中 <span class="math notranslate nohighlight">\( \theta\in\Theta_{0} \)</span> .</p></li>
<li><p>犯 <strong>第二类错误(Type II error)</strong> 的 <strong>概率</strong> 为
<span class="math notranslate nohighlight">\( 1-\beta\left(\theta\right) \)</span> , 其中 <span class="math notranslate nohighlight">\( \theta\in\Theta_{1} \)</span> .</p></li>
</ul>
<p>假设检验的哲学理念是一个争论不休的话题。目前, 统计学教科书中普遍采用的框架是 <strong>频率学派的观点</strong> 。频率学派认为参数是一个固定的常数。他们对第一类错误秉持着非常保守的态度: 只有在有充足证据的情况下, 才可以拒绝零假设。在“保护零假设”这一原则下, 一个理想的检验应该有一个较小的水平。传统上我们采用 <span class="math notranslate nohighlight">\( \alpha=0.01, 0.05\)</span> 或者 <span class="math notranslate nohighlight">\(0.1\)</span>。如果
<span class="math notranslate nohighlight">\( \beta\left(\theta\right) \geq\sup_{\theta\in\Theta_{0}}\beta\left(\theta\right) \)</span> , 我们说一个测试是 <strong>无偏的</strong> 。对于所有 <span class="math notranslate nohighlight">\( \Theta\in \Theta_{1} \)</span> 来说, 可以存在很多正确尺度的检验。</p>
<div class="proof example admonition" id="example-0">
<p class="admonition-title"><span class="caption-number">例子 8.1 </span></p>
<section class="example-content" id="proof-content">
<p>对于任意 <span class="math notranslate nohighlight">\( \theta\in\Theta \)</span> ，我们构造一个很简单的检验函数 <span class="math notranslate nohighlight">\( \phi(\mathbf{x}) =1\left\{ 0\leq U\leq\alpha\right\} \)</span> ，其中 <span class="math notranslate nohighlight">\( U \)</span> 是取自在 <span class="math notranslate nohighlight">\( \left[0, 1\right] \)</span> 上的均匀分布。该检验有着正确尺度的 <span class="math notranslate nohighlight">\( \alpha \)</span>，但功效未知。在另一极端情况下, 检验函数 <span class="math notranslate nohighlight">\( \phi\left(\mathbf{x}\right) =1 \)</span> 拥有最大的功效, 但尺度是错误的。</p>
</section>
</div><p>一般来说，假设检验的具体操作需要我们提出检验统计量 <span class="math notranslate nohighlight">\( T_{n}: \mathcal{X}^{n}\mapsto\mathbb{R}^{+} \)</span> 及相应的临界值 <span class="math notranslate nohighlight">\( c_{1-\alpha} \)</span>。对于给定的 <span class="math notranslate nohighlight">\( T_{n} \)</span> 与 <span class="math notranslate nohighlight">\( c_{1-\alpha} \)</span>，检验函数可写作：</p>
<div class="math notranslate nohighlight">
\[ 
\phi\left(\mathbf{X}\right) =1\left\{ T_{n}\left(\mathbf{X}\right) &gt;c_{1-\alpha}\right\} .
 \]</div>
<p>为了保证该检验 <span class="math notranslate nohighlight">\( \phi\left(\mathbf{x}\right) \)</span> 有着正确的尺度, 我们需要找到 <span class="math notranslate nohighlight">\( T_{n} \)</span> 在零假设下的分布(零分布，null distribution)，然后通过零假设与理想的检验尺度/水平, 找到一个临界值 <span class="math notranslate nohighlight">\( c_{1-\alpha} \)</span> 。</p>
<p>另一个在假设检验中常见的指标是 <span class="math notranslate nohighlight">\( p \)</span> -值:</p>
<div class="math notranslate nohighlight">
\[ 
\sup_{\theta\in\Theta_{0}}P_{\theta}\left\{ T_{n}\left(\mathbf{x}\right) \leq T_{n}\left(\mathbf{X}\right) \right\} .
 \]</div>
<p>在上述表达式中， <span class="math notranslate nohighlight">\( T_{n}\left(\mathbf{x}\right) \)</span> 是检验统计量 <span class="math notranslate nohighlight">\( T_{n} \)</span> 的实际数值, 而 <span class="math notranslate nohighlight">\( T_{n}\left(\mathbf{X}\right) \)</span> 是由零分布 <span class="math notranslate nohighlight">\( \theta\in\Theta_{0} \)</span> 产生的随机变量。 <span class="math notranslate nohighlight">\( p \)</span> -值的意义则是, 在零假设成立的情况下, 我们观测到 <span class="math notranslate nohighlight">\( T_{n}(\mathbf{X}) \)</span> 大于等于实际数值 <span class="math notranslate nohighlight">\( T_{n}(\mathbf{x}) \)</span> 的概率。</p>
<p>注意， <span class="math notranslate nohighlight">\( p \)</span> -值 <strong>不是</strong> 零假设为真的概率。在频率学派的观点下, 零假设只有“真”和“假”两种可能中的一种，它具有确定性。检验的随机性只来自抽样，不来自假设本身。 <span class="math notranslate nohighlight">\( p \)</span> -值衡量数据集是否与零假设相符，此只与它相应的检验相关。当 <span class="math notranslate nohighlight">\( p \)</span> 值小于指定的检验尺度 <span class="math notranslate nohighlight">\(\alpha\)</span> 时, 我们拒绝零假设。</p>
<p>到目前为止, 我们讨论了有限样本的假设检验。当 <span class="math notranslate nohighlight">\( n\to\infty \)</span> 时, 这些概念依然成立。如果我们把功效函数表示为 <span class="math notranslate nohighlight">\( \beta_{n}\left(\theta\right) \)</span> ，将其对样本量 <span class="math notranslate nohighlight">\(n\)</span> 的依赖明确标示。对于 <span class="math notranslate nohighlight">\( \theta\in\Theta_{0} \)</span> , 有 <span class="math notranslate nohighlight">\( \limsup_{n\to\infty}\beta_{n}\left(\theta\right) \leq\alpha \)</span>，那么这个检验的渐进尺度(asymptotic size) 为 <span class="math notranslate nohighlight">\( \alpha \)</span> 。</p>
<p>如果对于任意 <span class="math notranslate nohighlight">\( \theta\in\Theta_{1} \)</span>，都有 <span class="math notranslate nohighlight">\( \beta_{n}\left(\theta\right) \to1 \)</span>，那么该检验是 <strong>相合的(consistent)</strong>。</p>
</section>
</section>
<section id="id4">
<h2><span class="section-number">8.2. </span>最优性<a class="headerlink" href="#id4" title="永久链接至标题">#</a></h2>
<p>统计理论中, 同一个参数估计可以产生多个合理的估计值, 同一个假设检验也可以有多个合理的检验。在零假设 <span class="math notranslate nohighlight">\( \Psi_{\alpha}=\left\{ \phi: \sup_{\theta\in\Theta_{0}}\beta_{\phi}\left(\theta\right) \leq\alpha\right\} \)</span> 下( <span class="math notranslate nohighlight">\( \beta_{\phi}\left(\theta\right) \)</span> 中的下标 <span class="math notranslate nohighlight">\( \phi \)</span> 代表不同的检验)，对于有着相同水平 <span class="math notranslate nohighlight">\( \alpha \)</span> 的检验来说, 我们自然会偏好在备择假设的每个点都有着最高功效的 <span class="math notranslate nohighlight">\( \phi^{*} \)</span> , 也就是对于每个 <span class="math notranslate nohighlight">\( \phi\in\Psi_{\alpha} \)</span> 来说，都有</p>
<div class="math notranslate nohighlight">
\[ 
\beta_{\phi^{*}}\left(\theta\right) \geq\beta_{\phi}\left(\theta\right) .
 \]</div>
<p>如果这样的检验 <span class="math notranslate nohighlight">\( \phi^{*}\in\Psi_{\alpha} \)</span> 成立, 我们称之为 <strong>一致最大功效检验(uniformly
most powerful test)</strong>，简称UMP检验。</p>
<div class="proof example admonition" id="example-1">
<p class="admonition-title"><span class="caption-number">例子 8.2 </span></p>
<section class="example-content" id="proof-content">
<p>假设一个尺度为6的随机样本产生于</p>
<div class="math notranslate nohighlight">
\[
\left(X_{1}, \ldots, X_{6}\right) \sim\text{iid.}N\left(\theta, 1\right) , 
 \]</div>
<p>其中 <span class="math notranslate nohighlight">\( \theta \)</span> 是未知的。我们想要推断该正态分布的均值。零假设为 <span class="math notranslate nohighlight">\( H_{0} \)</span> : <span class="math notranslate nohighlight">\( \theta\leq0 \)</span> , 备择假设为 <span class="math notranslate nohighlight">\( H_{1} \)</span> : <span class="math notranslate nohighlight">\( \theta&gt;0 \)</span> 。所有满足</p>
<div class="math notranslate nohighlight">
\[ 
\Psi=\left\{ 1\left\{ \bar{X}\geq c/\sqrt{6}\right\} : c\geq1.64\right\}
 \]</div>
<p>的检验都有正确的水平。</p>
<p>因为 <span class="math notranslate nohighlight">\( \bar{X}=N\left(\theta, 1/6\right) \)</span> , 这些检验 <span class="math notranslate nohighlight">\( \Psi \)</span> 的功效函数为</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
\beta_{\phi}\left(\theta\right) &amp; =P\left(\bar{X}\geq\frac{c}{\sqrt{6}}\right) =P\left(\frac{\bar{X}-\theta}{1/\sqrt{6}}\geq\frac{\frac{c}{\sqrt{6}}-\theta}{1/\sqrt{6}}\right) \\
 &amp; =P\left(N\geq c-\sqrt{6}\theta\right) =1-\Phi\left(c-\sqrt{6}\theta\right) .\end{aligned}
 \end{split}\]</div>
<p>其中, 根据标准正态分布, <span class="math notranslate nohighlight">\( N=\frac{\bar{X}-\theta}{1/\sqrt{6}} \)</span> ； <span class="math notranslate nohighlight">\( \Phi \)</span> 是标准正态分布的CDF。</p>
<p>因为 <span class="math notranslate nohighlight">\( \beta_{\phi}\left(\theta\right) \)</span> 对 <span class="math notranslate nohighlight">\( c \)</span> 单调递减, 因此检验函数</p>
<div class="math notranslate nohighlight">
\[ 
\phi_{\theta=0}\left(\mathbf{X}\right) =1\left\{ \bar{X}\geq1.64/\sqrt{6}\right\}
 \]</div>
<p>在 <span class="math notranslate nohighlight">\( \Psi \)</span> 中功效最大, 因为 <span class="math notranslate nohighlight">\( c=1.64 \)</span> 是在保证水平 <span class="math notranslate nohighlight">\( \alpha \)</span> 不变的基础上, <span class="math notranslate nohighlight">\( c \)</span> 所能取的最下界。</p>
</section>
</div></section>
<section id="wilks">
<h2><span class="section-number">8.3. </span>似然比检验与Wilks定理<a class="headerlink" href="#wilks" title="永久链接至标题">#</a></h2>
<p>当估计值不能写作闭合形式时, 似然比检验(Likeelihood-ratio test, LRT)就起到重要作用。令样本的平均对数似然函数为 <span class="math notranslate nohighlight">\( \ell_{n}\left(\theta\right) =n^{-1}\sum_{i}\log f\left(x_{i};\theta\right) \)</span> , 那么 <span class="math notranslate nohighlight">\( \widehat{\theta}=\arg\max_{\theta\in\Theta}\ell_{n}\left(\theta\right) \)</span> 是最大似然估计值(maximum likelihood estimator, MLE)。在 <span class="math notranslate nohighlight">\( \ell_{n}\left(\widehat{\theta}\right) \)</span> 处对 <span class="math notranslate nohighlight">\( \ell_{n}\left(\theta_{0}\right) \)</span> 取泰勒展开:</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
\ell_{n}\left(\theta_{0}\right) -\ell_{n}\left(\widehat{\theta}\right) &amp; =\frac{\partial\ell_{n}}{\partial\theta}\left(\widehat{\theta}\right) '\left(\theta_{0}-\widehat{\theta}\right) +\frac{1}{2}\left(\theta_{0}-\widehat{\theta}\right) '\left(\frac{\partial^{2}}{\partial\theta\partial\theta'}\ell_{n}\left(\theta_{0}\right) \right) \left(\theta_{0}-\widehat{\theta}\right) +O\left(\left\Vert \widehat{\theta}-\theta_{0}\right\Vert _{2}^{3}\right) \\
 &amp; =\frac{1}{2}\left(\widehat{\theta}-\theta_{0}\right) '\left(\frac{\partial^{2}}{\partial\theta\partial\theta'}\ell_{n}\left(\theta_{0}\right) \right) \left(\widehat{\theta}-\theta_{0}\right) +O\left(\left\Vert \widehat{\theta}-\theta_{0}\right\Vert _{2}^{3}\right) \\
 &amp; =\frac{1}{2}\left(\widehat{\theta}-\theta_{0}\right) '\left(\frac{\partial^{2}}{\partial\theta\partial\theta'}\ell_{n}\left(\theta_{0}\right) \right) \left(\widehat{\theta}-\theta_{0}\right) +o_{p}\left(1\right) .\end{aligned}
 \end{split}\]</div>
<p>其中, 因为一阶条件, <span class="math notranslate nohighlight">\( \frac{\partial\ell_{n}}{\partial\theta}\left(\widehat{\theta}\right) =0 \)</span></p>
<p>定义 <span class="math notranslate nohighlight">\( L_{n}\left(\theta\right) : =\sum_{i}\log f\left(x_{i};\theta\right) \)</span> , <strong>似然比统计量(likelihood-ratio statistic)</strong> 为</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{LR}: =2\left(L_{n}\left(\widehat{\theta}\right) -L_{n}\left(\theta_{0}\right) \right) =2n\left(\ell_{n}\left(\widehat{\theta}\right) -\ell_{n}\left(\theta_{0}\right) \right) .
 \]</div>
<p>显然, 由于 <span class="math notranslate nohighlight">\( \widehat{\theta} \)</span> 最大化 <span class="math notranslate nohighlight">\( \ell_{n}\left(\theta\right) \)</span> , 有 <span class="math notranslate nohighlight">\( \mathcal{LR}\geq0 \)</span> 。泰勒展开式两边同乘 <span class="math notranslate nohighlight">\( -2n \)</span> , 得到</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{LR}=\sqrt{n}\left(\widehat{\theta}-\theta_{0}\right) '\left(-\frac{\partial^{2}}{\partial\theta\partial\theta'}\ell_{n}\left(\dot{\theta}\right) \right) \sqrt{n}\left(\widehat{\theta}-\theta_{0}\right) +o_{p}\left(1\right) .
 \]</div>
<p>注意, 当模型正确时, 我们能够得到：</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
-\frac{\partial^{2}}{\partial\theta\partial\theta'}\ell_{n}\left(\theta_{0}\right) &amp; \stackrel{p}{\to}-\mathcal{H}\left(\theta_{0}\right) =\mathcal{I}\left(\theta_{0}\right) \\
\sqrt{n}\left(\widehat{\theta}-\theta_{0}\right) &amp; \stackrel{d}{\to}N\left(0, \mathcal{I}^{-1}\left(\theta_{0}\right) \right) .\end{aligned}
 \end{split}\]</div>
<p>根据 Slutsky 定理，</p>
<div class="math notranslate nohighlight">
\[
\left(-\frac{\partial^{2}}{\partial\theta\partial\theta'}\ell_{n}\left(\dot{\theta}\right) \right) ^{1/2}\left[\sqrt{n}\left(\widehat{\theta}-\theta_{0}\right) \right]\stackrel{d}{\to}\mathcal{I}^{1/2}\left(\theta_{0}\right) \times N\left(0, \mathcal{I}^{-1}\left(\theta_{0}\right) \right) \sim N\left(0, I_{k}\right) .
 \]</div>
<p>根据连续映射定理，</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{LR}\stackrel{d}{\to}\chi_{K}^{2}.
 \]</div>
<div class="proof theorem admonition" id="theorem-2">
<p class="admonition-title"><span class="caption-number">定理 8.1 </span> (Wilks 定理)</p>
<section class="theorem-content" id="proof-content">
<p>当参数模型正确时， <span class="math notranslate nohighlight">\( \mathcal{LR}\stackrel{d}{\to}\chi^{2}\left(K\right) \)</span> 。</p>
</section>
</div><section id="score-test">
<h3><span class="section-number">8.3.1. </span>Score Test<a class="headerlink" href="#score-test" title="永久链接至标题">#</a></h3>
</section>
</section>
<section id="id5">
<h2><span class="section-number">8.4. </span>置信区间<a class="headerlink" href="#id5" title="永久链接至标题">#</a></h2>
<p><strong>区间估计(interval estimate)</strong> 是一个函数 <span class="math notranslate nohighlight">\( C: \mathcal{X}^{n}\mapsto\left\{ \Theta_{1}: \Theta_{1}\subseteq\Theta\right\} \)</span> , 它将样本空间中的点映射到参数空间。</p>
<p>区间估计量 <span class="math notranslate nohighlight">\( C\left(\mathbf{X}\right) \)</span> 的<strong>覆盖概率(coverage probability)</strong> 被定义为 <span class="math notranslate nohighlight">\( P_{\theta}\left(\theta\in C\left(\mathbf{X}\right) \right) \)</span> 。如果 <span class="math notranslate nohighlight">\( \theta \)</span> 是一维的，我们将区间估计量叫做 <strong>置信区间(confidence interval)</strong>。如果 <span class="math notranslate nohighlight">\( \theta \)</span> 是多维的，我们将区间估计量叫做 <strong>置信区域(confidence region)</strong>。当然，置信区域包括了一维置信区间的情况。覆盖概率是指区间估计量捕捉到生成样本的真实参数的频率。从频率学派的观点来看，真实参数 <span class="math notranslate nohighlight">\(\theta\)</span> 参数是固定的, 而置信区域是随机的。覆盖概率 <strong>不是</strong> <span class="math notranslate nohighlight">\( \theta \)</span> 在给定的置信区间内的概率。</p>
<div class="proof exercise admonition" id="exercise-3">
<p class="admonition-title"><span class="caption-number">练习 8.1 </span></p>
<section class="exercise-content" id="proof-content">
<p>假设一个尺度为6的随机样本产生于 <span class="math notranslate nohighlight">\(\left(X_{1}, \ldots, X_{6}\right) \sim\text{iid }N\left(\theta, 1\right).\)</span>
求随机区间 <span class="math notranslate nohighlight">\( \left[\bar{X}-1.96/\sqrt{6}, \ \bar{X}+1.96/\sqrt{6}\right] \)</span> 的覆盖概率。</p>
</section>
</div><p>假设检验和置信区域是密切相关的两个概念。有时, 直接构建置信区域是很困难的, 但检验假设却很容易。构建置信区域的一种方法是通过假设检验来反推(inversion)。若 <span class="math notranslate nohighlight">\( \phi_{\theta} \)</span> 是尺度为 <span class="math notranslate nohighlight">\( \alpha \)</span> 的检验，则 <span class="math notranslate nohighlight">\( C\left(\mathbf{X}\right) \)</span> 可以通过</p>
<div class="math notranslate nohighlight">
\[ 
C\left(\mathbf{X}\right) =\left\{ \theta\in\Theta: \phi\left(\mathbf{X}\right) =0\right\}, 
 \]</div>
<p>来构造，此时，真实参数 <span class="math notranslate nohighlight">\( \theta \)</span> 的覆盖概率为</p>
<div class="math notranslate nohighlight">
\[ 
P_{\theta}\left\{ \theta\in C\left(\mathbf{X}\right) \right\} =P_{\theta}\left\{ \phi\left(\mathbf{X}\right) =0\right\} =1-P_{\theta}\left\{ \phi\left(\mathbf{X}\right) =1\right\} =1-\beta\left(\theta\right) \geq1-\alpha, 
 \]</div>
<p>其中最后一个不等式是因为, 对于 <span class="math notranslate nohighlight">\( \theta\in\Theta_{0} \)</span> , 有 <span class="math notranslate nohighlight">\( \beta\left(\theta\right) \leq\alpha \)</span> 。如果 <span class="math notranslate nohighlight">\( \Theta_{0} \)</span> 是单元集, 那么等式成立。</p>
<p><strong>knitr</strong></p>
</section>
<section id="id6">
<h2><span class="section-number">8.5. </span>贝叶斯可信集<a class="headerlink" href="#id6" title="永久链接至标题">#</a></h2>
<p>贝叶斯框架为统计决策提供了另一套自然自洽的语言。然而, 对贝叶斯统计学的主要批评是来自其先验分布选择的任意性。</p>
<p>贝叶斯方法将数据 <span class="math notranslate nohighlight">\( \mathbf{X}_{n} \)</span> 和参数 <span class="math notranslate nohighlight">\( \theta \)</span> 都视为随机变量。在观察数据之前, 我们持有一个关于 <span class="math notranslate nohighlight">\( \theta \)</span> 的 <strong>先验分布</strong> <span class="math notranslate nohighlight">\(\pi\)</span> 。在观察数据之后, 我们将先验分布更新为 <strong>后验分布</strong> <span class="math notranslate nohighlight">\(p(\theta|\mathbf{X}_{n})\)</span> 。<strong>贝叶斯定理</strong> 连接了先验分布和后验分布:</p>
<div class="math notranslate nohighlight">
\[$ 
p(\theta|\mathbf{X}_{n}) \propto f(\mathbf{X}_{n}|\theta) \pi(\theta) .
 \]</div>
<p>其中 <span class="math notranslate nohighlight">\( f(\mathbf{X}_{n}|\theta) \)</span> 为似然函数。</p>
<div class="proof example admonition" id="example-4">
<p class="admonition-title"><span class="caption-number">例子 8.3 </span></p>
<section class="example-content" id="proof-content">
<p>这里有一个说明贝叶斯统计推断的经典案例。假设 <span class="math notranslate nohighlight">\( \mathbf{X}_{n}=(X_{1}, \ldots, X_{n}) \)</span> 是取自正态分布 <span class="math notranslate nohighlight">\( N(\theta, \sigma^2) \)</span> 的iid随机样本, 其中 <span class="math notranslate nohighlight">\( \theta \)</span> 未知， <span class="math notranslate nohighlight">\( \sigma \)</span> 已知。如果先验分布是 <span class="math notranslate nohighlight">\( \theta\sim N(\theta_{0}, \sigma_{0}^{2}) \)</span> , 那么根据计算, 后验分布可写作</p>
<div class="math notranslate nohighlight">
\[ 
p(\theta|\mathbf{x}_{n}) \sim N\left(\tilde{\theta}, \tilde{\sigma}^{2}\right) , 
 \]</div>
<p>其中， <span class="math notranslate nohighlight">\( \tilde{\theta}=\frac{\sigma^{2}}{n\sigma_{0}^{2}+\sigma^{2}}\theta_{0}+\frac{n\sigma_{0}^{2}}{n\sigma_{0}^{2}+\sigma^{2}}\bar{x} \)</span> , 并且 <span class="math notranslate nohighlight">\( \tilde{\sigma}^{2}=\frac{\sigma_{0}^{2}\sigma^{2}}{n\sigma_{0}^{2}+\sigma^{2}} \)</span>。因此, 这里的<strong>贝叶斯可信集(Bayesian credible set)</strong> 是</p>
<div class="math notranslate nohighlight">
\[ 
\left(\tilde{\theta}-z_{1-\alpha/2}\cdot\tilde{\sigma}, \ \tilde{\theta}+z_{1-\alpha/2}\cdot\tilde{\sigma}\right) .
 \]</div>
<p>后验分布取决于先验分布中的 <span class="math notranslate nohighlight">\( \theta_{0} \)</span> 与 <span class="math notranslate nohighlight">\( \sigma_{0}^{2} \)</span>。当样本量足够大时，后验分布可以用 <span class="math notranslate nohighlight">\( N(\bar{x}, \sigma^{2}/n) \)</span> 来近似，其中先验分布的信息被数据积累的信息所覆盖。</p>
<p>另一方面, 频率学派的会认为 <span class="math notranslate nohighlight">\( \hat{\theta}=\bar{x}\sim N(\theta, \sigma^{2}/n) \)</span> 。置信区间为</p>
<div class="math notranslate nohighlight">
\[ 
\left(\bar{x}-z_{1-\alpha/2}\cdot\sigma/\sqrt{n}, \ \bar{x}-z_{1-\alpha/2}\cdot\sigma/\sqrt{n}\right) .
 \]</div>
<p>对于有限的 <span class="math notranslate nohighlight">\( n \)</span> , 贝叶斯可信集与频率学派的置信区间是不同的；而当 <span class="math notranslate nohighlight">\( n\to\infty \)</span> 时, 二者等同。</p>
</section>
</div></section>
<section id="id7">
<h2><span class="section-number">8.6. </span>线性回归中的应用<a class="headerlink" href="#id7" title="永久链接至标题">#</a></h2>
<p>我们将介绍三种对线性回归系数假设的检验方法——Wald检验, 拉格朗日乘数(Lagrangian multiplier, LM) 检验, 似然比检验(LRT) 。Wald检验基于不受限制的OLS估计值 <span class="math notranslate nohighlight">\( \widehat{\beta} \)</span> ；LM检验基于限制性的OLS估计值 <span class="math notranslate nohighlight">\( \tilde{\beta} \)</span>；而LRT基于对数似然函数在不受限制的OLS估计值与受限制的OLS估计值之间的差值。</p>
<p>记 <span class="math notranslate nohighlight">\( R \)</span> 为一个 <span class="math notranslate nohighlight">\( q\times K \)</span> 的常数矩阵, 其中 <span class="math notranslate nohighlight">\( q\leq K \)</span> , <span class="math notranslate nohighlight">\( \mbox{rank}\left(R\right) =q \)</span> 。所有关于 <span class="math notranslate nohighlight">\( \beta \)</span> 的线性限制都可以写成 <span class="math notranslate nohighlight">\( R\beta=r \)</span> 的形式, 其中 <span class="math notranslate nohighlight">\( r \)</span> 是一个 <span class="math notranslate nohighlight">\( q\times1 \)</span> 的常量向量。</p>
<div class="proof example admonition" id="example-5">
<p class="admonition-title"><span class="caption-number">例子 8.4 </span></p>
<section class="example-content" id="proof-content">
<p>在上面的例子中, 我们想同时检验 <span class="math notranslate nohighlight">\( \beta_{1}=1 \)</span> 和 <span class="math notranslate nohighlight">\( \beta_{3}+\beta_{4}=2 \)</span> 。零假设可以表达为 <span class="math notranslate nohighlight">\( R\beta=r \)</span> , 其中限制矩阵 <span class="math notranslate nohighlight">\( R \)</span> 可写作</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
R=\begin{pmatrix}1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 1 &amp; 0
\end{pmatrix}.
 \end{split}\]</div>
<p>另外, <span class="math notranslate nohighlight">\( r=\left(1, 2\right) ' \)</span> 。</p>
</section>
</div><section id="wald">
<h3><span class="section-number">8.6.1. </span>Wald检验<a class="headerlink" href="#wald" title="永久链接至标题">#</a></h3>
<p>假设OLS估计量 <span class="math notranslate nohighlight">\( \widehat{\beta} \)</span> 是渐进正态的, 也就是说</p>
<div class="math notranslate nohighlight">
\[ 
\sqrt{n}\left(\widehat{\beta}-\beta\right) \stackrel{d}{\to}N\left(0, \Omega\right) , 
 \]</div>
<p>其中 <span class="math notranslate nohighlight">\( \Omega \)</span> 是一个 <span class="math notranslate nohighlight">\( K\times K \)</span> 的正定协方差矩阵。因为 <span class="math notranslate nohighlight">\( R\sqrt{n}\left(\widehat{\beta}-\beta\right) \stackrel{d}{\to}N\left(0, R\Omega R'\right) \)</span> , 二次型为：</p>
<div class="math notranslate nohighlight">
\[ 
n\left(\widehat{\beta}-\beta\right) 'R'\left(R\Omega R'\right) ^{-1}R\left(\widehat{\beta}-\beta\right) \stackrel{d}{\to}\chi_{q}^{2}.
 \]</div>
<p>现在我们想要检验线性的零假设 <span class="math notranslate nohighlight">\( R\beta=r \)</span> 。在零假设下, Wald统计量被定义为</p>
<div class="math notranslate nohighlight">
\[
\mathcal{W}=n\left(R\widehat{\beta}-r\right) '\left(R\widehat{\Omega}R'\right) ^{-1}\left(R\widehat{\beta}-r\right) \stackrel{d}{\to}\chi_{q}^{2}, 
 \]</div>
<p>其中 <span class="math notranslate nohighlight">\( \widehat{\Omega} \)</span> 是 <span class="math notranslate nohighlight">\( \Omega \)</span> 的相合估计量。</p>
<div class="admonition-single-test admonition">
<p class="admonition-title">Single test </p>
<p>在线性回归一个针对工资 <span class="math notranslate nohighlight">\( y \)</span> 的线性回归中, 自变量为</p>
<div class="math notranslate nohighlight">
\[ 
x=\left(\mbox{edu}, \mbox{age}, \mbox{experience}, \mbox{experience}^{2}, 1\right) '.
 \]</div>
<p>回归方程为</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}y &amp; =x_{i}'\beta+e_{i}=\sum_{k=1}^{5}\beta_{k}x_{ik}+e_{i}.\nonumber\\
E\left[e_{i}x_{i}\right] &amp; =\mathbf{0}_{5}.
\end{aligned}
 \end{split}\]</div>
<p>为了测试 <strong>教育</strong> 是否影响工资, 我们将零假设写作 <span class="math notranslate nohighlight">\( \beta_{1}=0 \)</span> 。令 <span class="math notranslate nohighlight">\( R=\left(1, 0, 0, 0, 0\right) \)</span> , <span class="math notranslate nohighlight">\( r=0 \)</span>。</p>
<div class="math notranslate nohighlight">
\[
 \sqrt{n}\widehat{\beta}_{1}=\sqrt{n}\left(\widehat{\beta}_{1}-\beta_{1}\right) =\sqrt{n}R\left(\widehat{\beta}-\beta\right) \stackrel{d}{\to}N\left(0, R\Omega R'\right) \sim N\left(0, \Omega_{11}\right) , \label{eq: R11} 
 \]</div>
<p>上式 <span class="math notranslate nohighlight">\( \Omega{}_{11} \)</span> 是 <span class="math notranslate nohighlight">\( \Omega \)</span> 的 <span class="math notranslate nohighlight">\( \left(1, 1\right) \)</span> 成分。在零假设下</p>
<div class="math notranslate nohighlight">
\[
H_{0}: R\beta=\left(1, 0, 0, 0, 0\right) \left(\beta_{1}, \ldots, \beta_{5}\right) '=\beta_{1}=0, 
 \]</div>
<p>我们有 <span class="math notranslate nohighlight">\( \sqrt{n}R\left(\widehat{\beta}-\beta\right) =\sqrt{n}\widehat{\beta}_{1}\stackrel{d}{\to}N\left(0, \Omega_{11}\right)\)</span> ，因此,</p>
<div class="math notranslate nohighlight">
\[ 
\sqrt{n}\frac{\widehat{\beta}_{1}}{\widehat{\Omega}_{11}^{1/2}}=\sqrt{\frac{\Omega_{11}}{\widehat{\Omega}_{11}}}\sqrt{n}\frac{\widehat{\beta}_{1}}{\sqrt{\Omega_{11}}}.
 \]</div>
<p>如果 <span class="math notranslate nohighlight">\( \widehat{\Omega}\stackrel{p}{\to}\Omega \)</span> , 那么根据连续映射定理， <span class="math notranslate nohighlight">\( \left(\Omega_{11}/\widehat{\Omega}_{11}\right) ^{1/2}\stackrel{p}{\to}1 \)</span>。由于 <span class="math notranslate nohighlight">\( \sqrt{n}\widehat{\beta}_{1}/\Omega_{11}^{1/2}\stackrel{d}{\to}N\left(0, 1\right) \)</span> , 有 <span class="math notranslate nohighlight">\( \sqrt{n}\widehat{\beta}_{1}/\widehat{\Omega}_{11}^{1/2}\stackrel{d}{\to}N\left(0, 1\right) . \)</span></p>
</div>
<div class="proof remark admonition" id="remark-6">
<p class="admonition-title"><span class="caption-number">评注 8.1 </span></p>
<section class="remark-content" id="proof-content">
<p>上面的例子是关于单个系数的检验, 检验统计量是 <strong>t</strong> -统计量的平方, 而零分布是标准正态分布的平方。</p>
</section>
</div><p>我们可以使用Delta方法来检验回归系数的非线性约束。</p>
<div class="proof example admonition" id="example-7">
<p class="admonition-title"><span class="caption-number">例子 8.5 </span></p>
<section class="example-content" id="proof-content">
<p>在线性回归中, 最佳的experience水平可以通过设置为一阶条件为0来寻找, 也就是 <span class="math notranslate nohighlight">\( \beta_{3}+2\beta_{4}\mbox{experience}^{*}=0 \)</span> 。我们试图检验, 最优的experience水平是否为20年, 也就是</p>
<div class="math notranslate nohighlight">
\[ 
\mbox{experience}^{*}=-\frac{\beta_{3}}{2\beta_{4}}=20.
 \]</div>
<p>这是一个非线性的假设。如果 <span class="math notranslate nohighlight">\( q\leq K \)</span> , <span class="math notranslate nohighlight">\( q \)</span> 是限制的数量, 我们有</p>
<div class="math notranslate nohighlight">
\[ 
n\left(f\left(\widehat{\theta}\right) -f\left(\theta_{0}\right) \right) '\left(\frac{\partial f}{\partial\theta}\left(\theta_{0}\right) \Omega\frac{\partial f}{\partial\theta}\left(\theta_{0}\right) '\right) ^{-1}\left(f\left(\widehat{\theta}\right) -f\left(\theta_{0}\right) \right) \stackrel{d}{\to}\chi_{q}^{2}.
 \]</div>
<p>在这个例子中, <span class="math notranslate nohighlight">\( \theta=\beta \)</span> , <span class="math notranslate nohighlight">\( f\left(\beta\right) =-\beta_{3}/\left(2\beta_{4}\right) \)</span>。其梯度为</p>
<div class="math notranslate nohighlight">
\[ 
\frac{\partial f}{\partial\beta'}\left(\beta\right) =\left(0, 0, -\frac{1}{2\beta_{4}}, \frac{\beta_{3}}{2\beta_{4}^{2}}, 0\right) .
 \]</div>
<p>因为 <span class="math notranslate nohighlight">\( \widehat{\beta}\stackrel{p}{\to}\beta_{0} \)</span> , 根据Continuous mapping theorem, 如果 <span class="math notranslate nohighlight">\( \beta_{0, 4}\neq0 \)</span> , 则有 <span class="math notranslate nohighlight">\( \frac{\partial}{\partial\beta}f\left(\widehat{\beta}\right) \stackrel{p}{\to}\frac{\partial}{\partial\beta}f\left(\beta_{0}\right) \)</span> .</p>
<p>因此, 非线性的Wald检验即为</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{W}=n\left(f\left(\widehat{\beta}\right) -20\right) '\left(\frac{\partial f}{\partial\beta'}\left(\widehat{\beta}\right) \widehat{\Omega}\frac{\partial f}{\partial\beta'}\left(\widehat{\beta}\right) \right) ^{-1}\left(f\left(\widehat{\beta}\right) -20\right) \stackrel{d}{\to}\chi_{1}^{2}.
 \]</div>
<p>这是一个渐进尺度正确的检验。</p>
</section>
</div><p>如果我们转换思路，上例的非线性假设可以写作线性零假设 <span class="math notranslate nohighlight">\( \beta_{3}+40\beta_{4}=0 \)</span> ，我们也可以因之构造出Wald统计量。一般来说, 在渐进等价的情况下, 线性假设比非线性假设更好, 因为在零假设下delta方法有近似误差。</p>
</section>
<section id="id8">
<h3><span class="section-number">8.6.2. </span>拉格朗日乘数检验<a class="headerlink" href="#id8" title="永久链接至标题">#</a></h3>
<p>Wald检验和LM检验的关键区别在于, 前者是非限制性的OLS估计, 而后者是限制性的OLS估计。估计限制性的OLS估计量</p>
<div class="math notranslate nohighlight">
\[ 
\min_{\beta}\left(y-X\beta\right) '\left(y-X\beta\right) \mbox{ s.t. }R\beta=r.
 \]</div>
<p>我们知道, 有限制的最优化问题可以转化为无限制的问题</p>
<div class="math notranslate nohighlight" id="equation-eq-lagran">
<span class="eqno">(8.1)<a class="headerlink" href="#equation-eq-lagran" title="公式的永久链接">#</a></span>\[$ 
L\left(\beta, \lambda\right) =\frac{1}{2n}\left(y-X\beta\right) '\left(y-X\beta\right) +\lambda'\left(R\beta-r\right) .
 \]</div>
<p>上式中 <span class="math notranslate nohighlight">\( L\left(\beta, \lambda\right) \)</span> 是拉格朗日函数, <span class="math notranslate nohighlight">\( \lambda \)</span> 是拉格朗日乘数。</p>
<p>LM检验又被叫做 <strong>score检验</strong> , 因为它依赖于受限OLS估计量的score函数。令<a class="reference internal" href="#equation-eq-lagran">(8.1)</a>中一阶条件为0:</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
\frac{\partial}{\partial\beta}L &amp; =-\frac{1}{n}X'\left(y-X\tilde{\beta}\right) +\tilde{\lambda}R=-\frac{1}{n}X'e+\frac{1}{n}X'X\left(\tilde{\beta}-\beta_{0}\right) +R'\tilde{\lambda}=0.\\
\frac{\partial}{\partial\lambda}L &amp; =R\tilde{\beta}-r=R\left(\tilde{\beta}-\beta_{0}\right) =0, \end{aligned}
 \end{split}\]</div>
<p>其中 <span class="math notranslate nohighlight">\( \tilde{\beta} \)</span> 和 <span class="math notranslate nohighlight">\( \tilde{\lambda} \)</span> 表示方程的根, <span class="math notranslate nohighlight">\( \beta_{0} \)</span> 是假设的真实值。这两个等式可写作一个线性系统</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{pmatrix}\widehat{Q} &amp; R'\\
R &amp; 0
\end{pmatrix}\begin{pmatrix}\tilde{\beta}-\beta_{0}\\
\tilde{\lambda}
\end{pmatrix}=\begin{pmatrix}\frac{1}{n}X'e\\
0
\end{pmatrix}, 
\end{split}\]</div>
<p>其中 <span class="math notranslate nohighlight">\( \hat{Q}=X'X/n \)</span> .</p>
<p>注意到</p>
<div class="math notranslate nohighlight" id="equation-eq-8-1">
<span class="eqno">(8.2)<a class="headerlink" href="#equation-eq-8-1" title="公式的永久链接">#</a></span>\[\begin{split} 
\begin{pmatrix}\widehat{Q}^{-1}-\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1} &amp; \widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}\\
\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1} &amp; -(R'Q^{-1}R) ^{-1}
\end{pmatrix}\begin{pmatrix}\widehat{Q} &amp; R'\\
R &amp; 0
\end{pmatrix}=I_{K+q}.
 \end{split}\]</div>
<p>基于<a class="reference internal" href="#equation-eq-8-1">(8.2)</a>, 我们可以写出表达式</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
\begin{pmatrix}\tilde{\beta}-\beta_{0}\\
\tilde{\lambda}
\end{pmatrix}\begin{aligned}=\end{aligned}
 &amp; \begin{pmatrix}\widehat{Q}^{-1}-\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1} &amp; \widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}\\
\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1} &amp; -(R'Q^{-1}R) ^{-1}
\end{pmatrix}\begin{pmatrix}\frac{1}{n}X'e\\
0
\end{pmatrix}\\
= &amp; \begin{pmatrix}\widehat{Q}^{-1}\frac{1}{n}X'e-\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{n}X'e\\
\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{n}X'e
\end{pmatrix}\end{aligned} 
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\( \tilde{\lambda} \)</span> 的组成部分是</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
\sqrt{n}\tilde{\lambda} &amp; =\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'e\\
 &amp; \stackrel{d}{\to}N\left(0, \left(RQ^{-1}R'\right) ^{-1}RQ^{-1}\Omega Q^{-1}R'\left(RQ^{-1}R'\right) ^{-1}\right) , \end{aligned}
 \end{split}\]</div>
<p>因为 <span class="math notranslate nohighlight">\( \widehat{Q}\stackrel{p}{\to}Q \)</span> .</p>
<p>记 <span class="math notranslate nohighlight">\( \Sigma=\left(RQ^{-1}R'\right) ^{-1}RQ^{-1}\Omega Q^{-1}R'\left(RQ^{-1}R'\right) ^{-1} \)</span> , 我们有</p>
<div class="math notranslate nohighlight">
\[ 
n\tilde{\lambda}'\Sigma^{-1}\tilde{\lambda}\stackrel{d}{\to}\chi_{q}^{2}.
 \]</div>
<p>令</p>
<div class="math notranslate nohighlight">
\[ 
\widehat{\Sigma}=\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\widehat{\Omega}\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}.
 \]</div>
<p>如果 <span class="math notranslate nohighlight">\( \widehat{\Omega}\stackrel{p}{\to}\Omega \)</span> , 我们有</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
\mathcal{LM} &amp; =n\tilde{\lambda}'\widehat{\Sigma}^{-1}\tilde{\lambda}=n\tilde{\lambda}'\Sigma^{-1}\tilde{\lambda}+n\tilde{\lambda}'\left(\widehat{\Sigma}^{-1}-\Sigma^{-1}\right) \tilde{\lambda}\\
 &amp; =n\tilde{\lambda}'\Sigma^{-1}\tilde{\lambda}+o_{p}\left(1\right) \stackrel{d}{\to}\chi_{q}^{2}.\end{aligned}
 \end{split}\]</div>
<p>这就是LM检验的一般表达形式。</p>
<p>在同方差性的特殊情况下, <span class="math notranslate nohighlight">\( \Sigma=\sigma^{2}\left(RQ^{-1}R'\right) ^{-1}RQ^{-1}QQ^{-1}R'\left(RQ^{-1}R'\right) ^{-1}=\sigma^{2}\left(RQ^{-1}R'\right) ^{-1}. \)</span></p>
<p>将 <span class="math notranslate nohighlight">\( \Sigma \)</span> 替换为估计值 <span class="math notranslate nohighlight">\( \hat{\Sigma} \)</span> , 我们有</p>
<div class="math notranslate nohighlight">
\[ 
\begin{aligned}\frac{n\tilde{\lambda}'R\hat{Q}^{-1}R'\tilde{\lambda}}{\hat{\sigma}^{2}} &amp; =\frac{1}{n\hat{\sigma}^{2}}\left(y-X\tilde{\beta}\right) 'X\hat{Q}^{-1}R'(R\hat{Q}^{-1}R') ^{-1}R\hat{Q}^{-1}X'\left(y-X\tilde{\beta}\right) \stackrel{d}{\to}\chi_{q}^{2}.\end{aligned}
 \]</div>
<div class="proof example admonition" id="example-8">
<p class="admonition-title"><span class="caption-number">例子 8.6 </span></p>
<section class="example-content" id="proof-content">
<p>现在, 如果我们检验最佳的experience水平是否为20年: <span class="math notranslate nohighlight">\( \mbox{experience}^{*}=-\frac{\beta_{3}}{2\beta_{4}}=20. \)</span> 那么, 我们
将 <span class="math notranslate nohighlight">\( \beta_{3} \)</span> 替换为 <span class="math notranslate nohighlight">\( -40\beta_{4} \)</span> , 就只用再检验三个斜率参数。另外, LM检验不受重新参数化的影响。</p>
</section>
</div></section>
<section id="id9">
<h3><span class="section-number">8.6.3. </span>似然比检验<a class="headerlink" href="#id9" title="永久链接至标题">#</a></h3>
<p>在上一节中, 我们已经讨论了LRT。这里我们把它放到具有高斯误差的线性回归背景下。令 <span class="math notranslate nohighlight">\( \gamma=\sigma_{e}^{2} \)</span> 。在回归模型的经典假设下,</p>
<div class="math notranslate nohighlight">
\[ 
L_{n}\left(\beta, \gamma\right) =-\frac{n}{2}\log\left(2\pi\right) -\frac{n}{2}\log\gamma-\frac{1}{2\gamma}\left(Y-X\beta\right) '\left(Y-X\beta\right) .
 \]</div>
<p>对于无限制的估计量, 我们知道</p>
<div class="math notranslate nohighlight">
\[
\widehat{\gamma}=\gamma\left(\widehat{\beta}\right) =n^{-1}\left(Y-X\widehat{\beta}\right) '\left(Y-X\widehat{\beta}\right) , 
 \]</div>
<p>并且样本的对数似然函数在最大化(MLE) 时可写作</p>
<div class="math notranslate nohighlight">
\[ 
\widehat{L}_{n}=L_{n}\left(\widehat{\beta}, \widehat{\gamma}\right) =-\frac{n}{2}\log\left(2\pi\right) -\frac{n}{2}\log\widehat{\gamma}-\frac{n}{2}.
 \]</div>
<p>对于有限制的估计量 <span class="math notranslate nohighlight">\( \tilde{L}_{n}=L_{n}\left(\tilde{\beta}, \tilde{\gamma}\right) =-\frac{n}{2}\log\left(2\pi\right) -\frac{n}{2}\log\tilde{\gamma}-\frac{n}{2} \)</span> , 似然比是</p>
<div class="math notranslate nohighlight">
\[ 
\begin{aligned}
\mathcal{LR} &amp; =2\left(\widehat{L}_{n}-\tilde{L}_{n}\right) =n\log\left(\tilde{\gamma}/\widehat{\gamma}\right) .\end{aligned}
 \]</div>
<p>如果回归模型的误差呈正态分布, 那么有 <span class="math notranslate nohighlight">\( \mathcal{LR}\stackrel{d}{\to}\chi_{q}^{2}. \)</span></p>
<p>现在, 我们抛弃误差呈正态分布这一假设, 但仍然保留条件同方差性。在这种情况下, 上面的结果并不适用, 因为 <span class="math notranslate nohighlight">\( L_{n}\left(\beta, \gamma\right) \)</span> 不再是对数似然函数, 我们在这里叫它 <strong>拟对数似然函数</strong> 。</p>
<p>根据 <span class="math notranslate nohighlight">\( \log\left(1+\frac{\tilde{\gamma}-\widehat{\gamma}}{\widehat{\gamma}}\right) \)</span> 在 <span class="math notranslate nohighlight">\( \log1=0 \)</span> 处的泰勒展开,</p>
<div class="math notranslate nohighlight" id="equation-eq-lrt1">
<span class="eqno">(8.3)<a class="headerlink" href="#equation-eq-lrt1" title="公式的永久链接">#</a></span>\[\begin{split} 
\begin{aligned}
\mathcal{LR} &amp; =n\log\left(1+\frac{\tilde{\gamma}-\widehat{\gamma}}{\widehat{\gamma}}\right) =n\left(\log1+\frac{\tilde{\gamma}-\widehat{\gamma}}{\widehat{\gamma}}+O\left(\frac{\left|\tilde{\gamma}-\widehat{\gamma}\right|^{2}}{\widehat{\gamma}^{2}}\right) \right) \nonumber \\
 &amp; =n\frac{\tilde{\gamma}-\widehat{\gamma}}{\widehat{\gamma}}+o_{p}\left(1\right) .\end{aligned}
 \end{split}\]</div>
<p>我们关注到</p>
<div class="math notranslate nohighlight" id="equation-eq-lrt2">
<span class="eqno">(8.4)<a class="headerlink" href="#equation-eq-lrt2" title="公式的永久链接">#</a></span>\[\begin{split} \begin{aligned}
n\left(\tilde{\gamma}-\widehat{\gamma}\right) &amp; =n\left(\gamma\left(\tilde{\beta}\right) -\gamma\left(\widehat{\beta}\right) \right) \nonumber \\
 &amp; =n\left(\frac{\partial\gamma\left(\widehat{\beta}\right) }{\partial\beta}\left(\tilde{\beta}-\widehat{\beta}\right) +\frac{1}{2}\left(\tilde{\beta}-\widehat{\beta}\right) '\frac{\partial^{2}\gamma\left(\widehat{\beta}\right) }{\partial\beta\partial\beta'}\left(\tilde{\beta}-\widehat{\beta}\right) +O\left(\left\Vert \tilde{\beta}-\widehat{\beta}\right\Vert _{2}^{3}\right) \right) \nonumber \\
 &amp; =\sqrt{n}\left(\tilde{\beta}-\widehat{\beta}\right) '\widehat{Q}\sqrt{n}\left(\tilde{\beta}-\widehat{\beta}\right) +o_{p}\left(1\right) , \end{aligned}
\end{split}\]</div>
<p>最后一行是因为 <span class="math notranslate nohighlight">\( \frac{\partial\gamma\left(\widehat{\beta}\right) }{\partial\beta}=-\frac{2}{n}X'\left(Y-X\widehat{\beta}\right) =-\frac{2}{n}X'\widehat{e}=0 \)</span> , 并且 <span class="math notranslate nohighlight">\( \frac{1}{2}\cdot\frac{\partial^{2}\gamma\left(\widehat{\beta}\right) }{\partial\beta\partial\beta'}=\frac{1}{2}\cdot\frac{2}{n}X'X=\widehat{Q} \)</span> .</p>
<p>根据LM检验的推导过程,</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}\sqrt{n}\left(\tilde{\beta}-\beta_{0}\right) &amp; =\left(\widehat{Q}^{-1}-\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\right) \frac{1}{\sqrt{n}}X'e\\
 &amp; =\frac{1}{\sqrt{n}}\left(X'X\right) ^{-1}X'e-\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'e\\
 &amp; =\sqrt{n}\left(\widehat{\beta}-\beta_{0}\right) -\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'e.
\end{aligned} 
\end{split}\]</div>
<p>重新排列得</p>
<div class="math notranslate nohighlight">
\[ 
 \sqrt{n}\left(\tilde{\beta}-\widehat{\beta}\right) =-\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'e.
\]</div>
<p>因此, 二次型可写作</p>
<div class="math notranslate nohighlight" id="equation-eq-lrt3">
<span class="eqno">(8.5)<a class="headerlink" href="#equation-eq-lrt3" title="公式的永久链接">#</a></span>\[\begin{split} 
\begin{aligned}
 &amp;  &amp; \sqrt{n}\left(\tilde{\beta}-\widehat{\beta}\right) '\widehat{Q}\sqrt{n}\left(\tilde{\beta}-\widehat{\beta}\right) \nonumber \\
 &amp; = &amp; \frac{1}{\sqrt{n}}e'X\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\widehat{Q}\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'e\nonumber \\
 &amp; = &amp; \frac{1}{\sqrt{n}}e'X\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'e\nonumber \\
 &amp; = &amp; \frac{1}{\sqrt{n}}e'X\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'e.\end{aligned}
\end{split}\]</div>
<p>结合<a class="reference internal" href="#equation-eq-lrt1">(8.3)</a>, <a class="reference internal" href="#equation-eq-lrt2">(8.4)</a>, <a class="reference internal" href="#equation-eq-lrt3">(8.5)</a>, 有</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
\mathcal{LR} &amp; =n\frac{\sigma_{e}^{2}}{\widehat{\gamma}}\cdot\frac{\tilde{\gamma}-\widehat{\gamma}}{\sigma_{e}^{2}}+o_{p}\left(1\right) \\
 &amp; =\frac{\sigma_{e}^{2}}{\widehat{\gamma}}\frac{1}{\sqrt{n}}\frac{e}{\sigma_{e}}'X\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'\frac{e}{\sigma_{e}}+o_{p}\left(1\right) .\end{aligned}
 \end{split}\]</div>
<p>在同方差的假设下, 中心极限定理说明</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'\frac{e}{\sigma_{e}} &amp; =R\widehat{Q}^{-1/2}\widehat{Q}^{-1/2}\frac{1}{\sqrt{n}}X'\frac{e}{\sigma_{e}}\\
 &amp; \stackrel{d}{\to}RQ^{-1/2}\times N\left(0, I_{K}\right) \sim N\left(0, RQ^{-1}R'\right) , \end{aligned}
 \end{split}\]</div>
<p>因此</p>
<div class="math notranslate nohighlight">
\[ 
 \frac{1}{\sqrt{n}}\frac{e}{\sigma_{e}}'X\widehat{Q}^{-1}R'\left(R\widehat{Q}^{-1}R'\right) ^{-1}R\widehat{Q}^{-1}\frac{1}{\sqrt{n}}X'\frac{e}{\sigma_{e}}\stackrel{d}{\to}\chi_{q}^{2}.
 \]</div>
<p>另外, <span class="math notranslate nohighlight">\( \frac{\sigma_{e}^{2}}{\widehat{\gamma}}\stackrel{p}{\to}1 \)</span> .根据 Slutsky’s theorem, 在同方差的假设下, 我们有</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{LR}\stackrel{d}{\to}\chi_{q}^{2}.
 \]</div>
</section>
</section>
<section id="id10">
<h2><span class="section-number">8.7. </span>总结<a class="headerlink" href="#id10" title="永久链接至标题">#</a></h2>
<p>不少应用计量经济学家希望在变量间建立统计学上的关联关系，甚至建立因果关系，因此他们非常看重假设检验，更有甚者，成为痴迷的观星者(stargazer)。假设检验是统计学中的重要领域。表格<a class="reference internal" href="#mytable"><span class="std std-ref">表格8.1</span></a>中的状态和决策提醒了我们它和博弈论的关系。我作为一个参与者，正在与自然界进行一个序列博弈。</p>
<ul class="simple">
<li><p>Step 0:  根据某个科学理论, 参数空间 <span class="math notranslate nohighlight">\( \Theta \)</span> 被划分为零假设 <span class="math notranslate nohighlight">\( \Theta_{0} \)</span> 和备择假设 <span class="math notranslate nohighlight">\( \Theta_{1} \)</span> 。</p></li>
<li><p>Step 1:  在我观察数据之前, 我根据 <span class="math notranslate nohighlight">\( \Theta_{0}\)</span> 和 <span class="math notranslate nohighlight">\( \Theta_{1} \)</span> 设计了一个检验函数 <span class="math notranslate nohighlight">\( \phi \)</span> 。用博弈论的术语来说, <span class="math notranslate nohighlight">\( \phi \)</span> 就是我的 <strong>策略</strong> 。</p></li>
<li><p>Step 2: 一旦我观察到数据 <span class="math notranslate nohighlight">\( \mathbf{x} \)</span> , 我就按照 <span class="math notranslate nohighlight">\( \phi\left(\mathbf{x}\right) \)</span> 的指令行事——要么接受 <span class="math notranslate nohighlight">\( \Theta_{0} \)</span> , 要么拒绝 <span class="math notranslate nohighlight">\( \Theta_{0} \)</span> 。</p></li>
<li><p>Step 3: 自然界揭示了 <span class="math notranslate nohighlight">\( \mathbf{x} \)</span> 背后的真实参数 <span class="math notranslate nohighlight">\( \theta^{*} \)</span> , 而我可以评估我的决定的收益/损失 <span class="math notranslate nohighlight">\( \phi\left(\mathbf{x}\right) \)</span> 。</p></li>
</ul>
<p>当损失函数(负收益函数) 写作</p>
<div class="math notranslate nohighlight">
\[ 
\mathscr{L}\left(\theta, \phi\left(\mathbf{x}\right) \right) =\phi\left(\mathbf{x}\right) \cdot1\left\{ \theta\in\Theta_{0}\right\} +\left(1-\phi\left(\mathbf{x}\right) \right) \cdot1\left\{ \theta\in\Theta_{1}\right\} , 
 \]</div>
<p>数据的随机性会带来风险(期望损失)</p>
<div class="math notranslate nohighlight">
\[ 
\mathscr{R}\left(\theta, \phi\right) =E\left[\mathscr{L}\left(\theta, \phi\left(\mathbf{x}\right) \right) \right]=\beta_{\phi}\left(\theta\right) \cdot1\left\{ \theta\in\Theta_{0}\right\} +\left(1-\beta_{\phi}\left(\theta\right) \right) \cdot1\left\{ \theta\in\Theta_{1}\right\} .
 \]</div>
<p>我是一个理性的人。我了解游戏的结构之后，将力图在Step 1中好好设计我的策略，尽量降低我的风险。</p>
<p>如果我是一个频率学家, 要么 <span class="math notranslate nohighlight">\( 1\left\{ \theta\in\Theta_{0}\right\} \)</span> 发生, 要么 <span class="math notranslate nohighlight">\( 1\left\{ \theta\in\Theta_{1}\right\} \)</span> 发生。一个无偏的检验保证了 <span class="math notranslate nohighlight">\( \sup_{\theta\in\Theta_{0}}\beta_{\phi}\left(\theta\right) \leq\alpha \)</span>。在许多无偏的检验中，我要选择最好的那个。在一系列尺度为 <span class="math notranslate nohighlight">\( \alpha \)</span> 的无偏检验 <span class="math notranslate nohighlight">\( \Psi_{\alpha} \)</span> 中，如果存在一致功效最大的检验 <span class="math notranslate nohighlight">\( \phi^{*} \)</span>，则对于任意 <span class="math notranslate nohighlight">\( \theta\in\Theta_{1} \)</span> ，都有 <span class="math notranslate nohighlight">\( \mathscr{R}\left(\theta, \phi^{*}\right) \geq\sup_{\phi\in\Psi_{\alpha}}\mathscr{R}\left(\theta, \phi\right) \)</span> 。当零假设与备择假设都是简单假设时, 根据 Neyman-Pearson 引理，似然比检验是一致功效最大的检验。</p>
<p>如果我是一个贝叶斯学家，我不介意将概率(权重)加于参数空间，这是我的先验信念 <span class="math notranslate nohighlight">\( \pi\left(\theta\right) \)</span>。那么我的贝叶斯风险为</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{aligned}
\mathscr{BR}\left(\pi, \phi\right) &amp; =E_{\pi\left(\theta\right) }\left[\mathscr{R}\left(\theta, \phi\right) \right]=\int\left[\beta_{\phi}\left(\theta\right) \cdot1\left\{ \theta\in\Theta_{0}\right\} +\left(1-\beta_{\phi}\left(\theta\right) \right) \cdot1\left\{ \theta\in\Theta_{1}\right\} \right]\pi\left(\theta\right) d\theta\\
 &amp; =\int_{\left\{ \theta\in\Theta_{0}\right\} }\beta_{\phi}\left(\theta\right) \pi\left(\theta\right) d\theta+\int_{\left\{ \theta\in\Theta_{1}\right\} }(1-\beta_{\phi}\left(\theta\right) ) \pi\left(\theta\right) d\theta.\end{aligned}
 \end{split}\]</div>
<p>这是一个在 <span class="math notranslate nohighlight">\( \pi\left(\theta\right) \)</span> 下平均零假设与备择假设过后的风险。</p>
<div class="admonition- admonition">
<p class="admonition-title">历史趣闻</p>
<p>假设检验形成于20世纪初。Karl Pearson(1957–1936) 奠定了假设检验的基础, 并引入了 <span class="math notranslate nohighlight">\( \chi^{2} \)</span> 检验、 <span class="math notranslate nohighlight">\( p \)</span> 值, 以及我们今天一直在使用的许多其他概念。Neyman-Pearson 引理是由 Jerzy Neyman(1894–1981) 与 Egon Pearson(1895–1980) 命名的, 后者是 Karl Pearson 的儿子。</p>
</div>
<div class="admonition- admonition">
<p class="admonition-title">拓展阅读</p>
<p><span id="id11">[<a class="reference internal" href="bibfile_place.html#id16" title="G Alastair Young and Robert Leslie Smith. Essentials of statistical inference. Volume 16. Cambridge University Press, 2005.">Young and Smith, 2005</a>]</span>是一本简明而深入的统计推断参考书。</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="lecture6-CN.html" title="上一页 页">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">上一页</p>
            <p class="prev-next-title"><span class="section-number">7. </span>最小二乘法:渐近性质</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="lecture9-CN.html" title="下一页 页">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">下一页</p>
        <p class="prev-next-title"><span class="section-number">9. </span>面板数据</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By 史震涛 Shi Zhentao<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>