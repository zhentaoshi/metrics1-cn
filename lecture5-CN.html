
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5. 基本渐近理论 &#8212; 计量经济学讲义</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. 假设检验" href="lecture8-CN.html" />
    <link rel="prev" title="4. 最小二乘法: 有限样本理论" href="lecture4-CN.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">计量经济学讲义</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    前言
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lecture1-CN.html">
   1. 概率论
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture2-CN.html">
   2. 投影
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture3-CN.html">
   3. 最小二乘法：线性代数观点
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture4-CN.html">
   4. 最小二乘法: 有限样本理论
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5. 基本渐近理论
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture8-CN.html">
   6. 假设检验
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/zhentaoshi/metrics1-cn/master?urlpath=tree/docs/lecture5-CN.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/zhentaoshi/metrics1-cn"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/zhentaoshi/metrics1-cn/issues/new?title=Issue%20on%20page%20%2Flecture5-CN.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/lecture5-CN.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   5.1. 随机变量的收敛模式
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   5.2. 大数定律
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chebyshev">
     5.2.1. Chebyshev大数定律
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kolmogorov">
     5.2.2. Kolmogorov大数定律
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   5.3. 中心极限定理
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   5.4. 转化方法
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   5.5. 总结
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>基本渐近理论</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   5.1. 随机变量的收敛模式
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   5.2. 大数定律
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chebyshev">
     5.2.1. Chebyshev大数定律
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kolmogorov">
     5.2.2. Kolmogorov大数定律
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   5.3. 中心极限定理
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   5.4. 转化方法
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   5.5. 总结
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">5. </span>基本渐近理论<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<div class="admonition- admonition">
<p class="admonition-title">赤壁赋</p>
<p>寄蜉蝣于天地，渺沧海之一粟。哀吾生之须臾，羡长江之无穷。挟飞仙以遨游，抱明月而长终。</p>
</div>
<hr class="docutils" />
<p>我们身处的浩瀚宇宙当中, 原子的数目小于<span class="math notranslate nohighlight">\(10^{82}\)</span>个. 尽管这是一个天文数字，但物理世界将它限定为一个有限的数字. 相反, 数学思想并不受制于现实. 渐进理论 (asymptotic theory) 是一门有关无限的艺术, 它研究统计量在样本量趋于无穷大之时的性质与行为. 它用一系列“近似”操作来简化复杂的有限样本问题. 它超越了有限样本理论所涵盖范围, 揭示了在更普遍情况下的统计估计与推断理论.</p>
<p>然而现实与理想相悖：我们手中的样本量总是有限的, 而且在大多数情况下, 我们也很难去增加样本量. 渐近理论虽然研究无穷大, 却不能准确回答 “多大才是大”这个问题. 因此, 我们必须警惕 <em>渐近乌托邦 (asymptopia)</em> 的出现. 在大数据时代, 尽管数据的规模急剧膨胀, 同时我们希望建立复杂的模型来更好地捕捉数据的异质性. 大样本是一个相对的概念, 依赖于模型的复杂性和数据的基本生成过程.</p>
<p>一方面，经典的参数化方法建立在难以验证的参数假设之上. 另一方面，渐进理论以假想的无限序列为前提. 可以说, 二者都偏离了现实. 哪种方法更有建设性? 我们只能根据具体情况来判断. 渐进理论的优点在于它数学上的普遍性与易操作性. 它是现代统计理论的基石.</p>
<section id="id2">
<h2><span class="section-number">5.1. </span>随机变量的收敛模式<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>首先回顾一下什么是非随机序列的收敛.</p>
<div class="proof definition admonition" id="con_of_dv">
<p class="admonition-title"><span class="caption-number">Definition 5.1 </span> (非随机序列的收敛)</p>
<section class="definition-content" id="proof-content">
<p>假设 <span class="math notranslate nohighlight">\(z_{1}, z_{2}, \ldots\)</span> 是一个非随机的无限序列. 如果对于任意 <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span>, 存在 <span class="math notranslate nohighlight">\(N\left(\varepsilon\right)\)</span> 使得：对于所有 <span class="math notranslate nohighlight">\(n&gt;N\left(\varepsilon\right)\)</span>, 都有
<span class="math notranslate nohighlight">\(\left|z_{n}-z\right|&lt;\varepsilon\)</span>, 那么称 <span class="math notranslate nohighlight">\(\{z_n\}\)</span> 是收敛序列.</p>
<p>我们将 <span class="math notranslate nohighlight">\(z\)</span> 称作 <span class="math notranslate nohighlight">\(z_{n}\)</span> 的极限, 并记 <span class="math notranslate nohighlight">\(z_{n}\to z\)</span>, 或者 <span class="math notranslate nohighlight">\(\lim_{n\to\infty}z_{n}=z\)</span>.</p>
</section>
</div><p>然而我们感兴趣的不是确定性序列, 而是随机变量序列. 何谓随机变量的收敛? 我们在此定义几种随机变量的收敛模式. 设 <span class="math notranslate nohighlight">\(\left(z_{n}\right)\)</span> 是一个随机变量序列, <span class="math notranslate nohighlight">\(z\)</span> 是随机变量或非随机常数.</p>
<div class="proof definition admonition" id="con_in_prob">
<p class="admonition-title"><span class="caption-number">Definition 5.2 </span> (依概率收敛, Convergence in probability)</p>
<section class="definition-content" id="proof-content">
<p>如果对于任意 <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span>, 当 <span class="math notranslate nohighlight">\(n\to\infty\)</span> 时, 都有 <span class="math notranslate nohighlight">\(P\left\{ \omega:\left|z_{n}\left(\omega\right)-z\right|&lt;\varepsilon\right\} \to 1\)</span> (或者等价地, <span class="math notranslate nohighlight">\(P\left\{ \omega:\left|z_{n}\left(\omega\right)-z\right|\geq\varepsilon\right\} \to0\)</span>) , 则称随机变量序列 <span class="math notranslate nohighlight">\(\left(z_{n}\right)\)</span> 依概率收敛到 <span class="math notranslate nohighlight">\(z\)</span>, 记作 <span class="math notranslate nohighlight">\(z_{n}\stackrel{p}{\to}z\)</span>.</p>
</section>
</div><div class="proof definition admonition" id="con_in_ms">
<p class="admonition-title"><span class="caption-number">Definition 5.3 </span> (均方收敛, Convergence in mean square)</p>
<section class="definition-content" id="proof-content">
<p>如果当 <span class="math notranslate nohighlight">\(n\to\infty\)</span> 时, <span class="math notranslate nohighlight">\(E\left[\left(z_{n}-z\right)^{2}\right]\to0\)</span>， 则称随机变量序列<span class="math notranslate nohighlight">\(\left(z_{n}\right)\)</span> 均方收敛到 <span class="math notranslate nohighlight">\(z\)</span>, 记作 <span class="math notranslate nohighlight">\(z_{n}\stackrel{m. s. }{\to}z\)</span>.</p>
</section>
</div><p>在 <a class="reference internal" href="#con_in_prob">Definition 5.2</a> 与 <a class="reference internal" href="#con_in_ms">Definition 5.3</a> 中, <span class="math notranslate nohighlight">\(P\left\{ \omega:\left|z_{n}\left(\omega\right)-z\right|&gt;\varepsilon\right\}\)</span> 与 <span class="math notranslate nohighlight">\(E\left[\left(z_{n}-z\right)^{2}\right]\)</span> 都是非随机的. 它们依非随机序列的收敛方式 (<a class="reference internal" href="#con_of_dv">Definition 5.1</a>) 趋近于0.</p>
<p>注意, 均方收敛的假设比依概率收敛的假设更强. 也就是说, 可以从 <span class="math notranslate nohighlight">\(z_{n}\stackrel{m. s. }{\to}z\)</span> 推导出 <span class="math notranslate nohighlight">\(z_{n}\stackrel{p}{\to}z\)</span>, 但反过来不成立. 下面是一个例子.</p>
<div class="proof example admonition" id="in_p_in_ms">
<p class="admonition-title"><span class="caption-number">Example 5.1 </span></p>
<section class="example-content" id="proof-content">
<p><span class="math notranslate nohighlight">\((z_{n})\)</span> 是一个随机变量序列. <span class="math notranslate nohighlight">\(z_{n}=\sqrt{n}\)</span> 的概率为 <span class="math notranslate nohighlight">\(1/n\)</span>, <span class="math notranslate nohighlight">\(z_{n}=0\)</span> 的概率为 <span class="math notranslate nohighlight">\(1-1/n\)</span>. 那么 <span class="math notranslate nohighlight">\(z_{n}\stackrel{p}{\to}0\)</span>, 但 <span class="math notranslate nohighlight">\(z_{n}\stackrel{m. s. }{\nrightarrow}0.\)</span></p>
<div class="proof admonition" id="proof">
<p>Proof. 注意到, 对于任意 <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span>, <span class="math notranslate nohighlight">\(P\left(\omega:\left|z_{n}\left(\omega\right)-0\right|&lt;\varepsilon\right)=P\left(\omega:z_{n}\left(\omega\right)=0\right)=1-1/n\rightarrow1\)</span>, 因此 <span class="math notranslate nohighlight">\(z_{n}\stackrel{p}{\to}0\)</span>. 同时, <span class="math notranslate nohighlight">\(E\left[\left(z_{n}-0\right)^{2}\right]=n\cdot1/n+0\cdot(1-1/n)=1\nrightarrow0\)</span>, 所以 <span class="math notranslate nohighlight">\(z_{n}\stackrel{m. s. }{\nrightarrow}0\)</span>.</p>
</div>
</section>
</div><div class="proof remark admonition" id="remark1">
<p class="admonition-title"><span class="caption-number">Remark 5.1 </span></p>
<section class="remark-content" id="proof-content">
<p><a class="reference internal" href="#in_p_in_ms">Example 5.1</a> 揭示了两种收敛方式的不同. 依概率收敛并不考虑小概率事件是后果, 而均方收敛涉考虑的则是整个概率空间上的平均值. 如果某个随机变量可以取一个巨大的值, 即使这是小概率事件, 它也可能会影响均方收敛, 却并不会破坏依概率收敛.</p>
</section>
</div><p>依概率收敛与均方收敛都事关一个随机变量收敛至另一个随机变量或者常数. 也就是说, 当 <span class="math notranslate nohighlight">\(n\to\infty\)</span> 时, <span class="math notranslate nohighlight">\(z_{n}-z\)</span> 的分布聚集在 0 左右. 但是, <em>依分布收敛 (convergence in distribution</em>) 关心的却是累积分布函数的收敛方式, 并非随机变量本身的收敛.</p>
<div class="proof definition admonition" id="con_in_dist">
<p class="admonition-title"><span class="caption-number">Definition 5.4 </span> (依分布收敛, Convergence in distribution)</p>
<section class="definition-content" id="proof-content">
<p>设 <span class="math notranslate nohighlight">\(F_{z_{n}}\left(\cdot\right)\)</span> 随机变量序列 <span class="math notranslate nohighlight">\(z_{n}\)</span> 的累积分布函数, <span class="math notranslate nohighlight">\(F_{z}\left(\cdot\right)\)</span> 的累计分布函数. 如果对于 <span class="math notranslate nohighlight">\(F_{z}\left(\cdot\right)\)</span> 的任意连续点 <span class="math notranslate nohighlight">\(a\in\mathbb{R}\)</span>, 当 <span class="math notranslate nohighlight">\(n\to\infty\)</span> 时, 都有 <span class="math notranslate nohighlight">\(F_{z_{n}}\left(a\right)\to F_{z}\left(a\right)\)</span>, 那么称随机变量序列<span class="math notranslate nohighlight">\(\left(z_{n}\right)\)</span> 依分布收敛到随机变量 <span class="math notranslate nohighlight">\(z\)</span>, 记作 <span class="math notranslate nohighlight">\(z_{n}\stackrel{d}{\to}z\)</span>.</p>
</section>
</div><p>依分布收敛是一种很弱的收敛方式. 如果 <span class="math notranslate nohighlight">\(z_{n}\stackrel{p}{\to}z\)</span>, 则 <span class="math notranslate nohighlight">\(z_{n}\stackrel{d}{\to}z\)</span>. 反之不一定成立, 除非 <span class="math notranslate nohighlight">\(z\)</span> 是一个(非随机)常数 (常数 <span class="math notranslate nohighlight">\(z\)</span> 可以被视作一个退化的随机变量, 其累积分布函数可写作 <span class="math notranslate nohighlight">\(F_{z}\left(\cdot\right)=1\left\{ \cdot\geq z\right\}\)</span>) .</p>
<div class="proof example admonition" id="in_p_in_dist">
<p class="admonition-title"><span class="caption-number">Example 5.2 </span></p>
<section class="example-content" id="proof-content">
<p>假设 <span class="math notranslate nohighlight">\(x\sim N\left(0, 1\right)\)</span>.</p>
<ul class="simple">
<li><p>若 <span class="math notranslate nohighlight">\(z_{n}=x+1/n\)</span>, 则 <span class="math notranslate nohighlight">\(z_{n}\stackrel{p}{\to}x\)</span>, 且 <span class="math notranslate nohighlight">\(z_{n}\stackrel{d}{\to}x\)</span>.</p></li>
<li><p>若 <span class="math notranslate nohighlight">\(z_{n}=-x+1/n\)</span>, 或 <span class="math notranslate nohighlight">\(z_{n}=y+1/n\)</span> (其中 <span class="math notranslate nohighlight">\(y\sim N\left(0, 1\right)\)</span> 与 <span class="math notranslate nohighlight">\(x\)</span> 独立) , 则 <span class="math notranslate nohighlight">\(z_{n}\stackrel{p}{\to}x\)</span>, 但 <span class="math notranslate nohighlight">\(z_{n}\stackrel{p}{\nrightarrow}x\)</span>.</p></li>
</ul>
</section>
</div><div class="proof example admonition" id="in_dist">
<p class="admonition-title"><span class="caption-number">Example 5.4 </span></p>
<section class="example-content" id="proof-content">
<p><span class="math notranslate nohighlight">\((z_{n})\)</span> 是一个随机变量序列. <span class="math notranslate nohighlight">\(z_{n}=\sqrt{n}\)</span> 的概率为 <span class="math notranslate nohighlight">\(1/\sqrt{n}\)</span>, <span class="math notranslate nohighlight">\(z_{n}=0\)</span> 的概率为 <span class="math notranslate nohighlight">\(1-1/\sqrt{n}\)</span>. 那么 <span class="math notranslate nohighlight">\(z_{n}\stackrel{d}{\to}z=0\)</span>.</p>
<div class="proof admonition" id="proof">
<p>Proof. 注意到</p>
<div class="math notranslate nohighlight">
\[\begin{split}
F_{z_{n}}\left(a\right)=\begin{cases}
0 &amp; a&lt;0\\
1-1/\sqrt{n} &amp; 0\leq a\leq n\\
1 &amp; a\geq n
\end{cases}. 
\end{split}\]</div>
<p>同时,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
F_{z}\left(a\right)=\begin{cases} 0, &amp; a&lt;0\\ 1 &amp; a\geq0 \end{cases}. 
\end{split}\]</div>
<p>易验证, 在定义域 <span class="math notranslate nohighlight">\(\left(-\infty, 0\right)\cup\left(0, +\infty\right)\)</span> 上, <span class="math notranslate nohighlight">\(F_{z_{n}}\left(a\right)\)</span> 逐点收敛于 <span class="math notranslate nohighlight">\(F_{z}\left(a\right)\)</span>, 其中 <span class="math notranslate nohighlight">\(F_{z}\left(a\right)\)</span> 是连续函数.</p>
</div>
</section>
</div><p>到目前为止, 我们已经讨论了随机标量的收敛性. 这三种收敛模式可以很容易地推广到随机向量. 具体来说, 可以运用 <em>Cramer-Wold device</em>, 通过任意的线性组合, 将随机向量折叠成随机标量. 假设 <span class="math notranslate nohighlight">\(\left(z_{n}\right)\)</span> 是一个 <span class="math notranslate nohighlight">\(K\)</span> 维的随机向量序列, <span class="math notranslate nohighlight">\(z\)</span> 是一个<span class="math notranslate nohighlight">\(K\)</span> 维向量. 如果对于任意 <span class="math notranslate nohighlight">\(\lambda\in\mathbb{R}^{K}\)</span>, <span class="math notranslate nohighlight">\(\left\Vert \lambda\right\Vert _{2}=1\)</span>, 都有 <span class="math notranslate nohighlight">\(\lambda'z_{n}\stackrel{d}{\to}\lambda'z\)</span>, 则称随机向量序列 <span class="math notranslate nohighlight">\(\left(z_{n}\right)\)</span> 依分布收敛到 <span class="math notranslate nohighlight">\(z\)</span>.</p>
</section>
<section id="id3">
<h2><span class="section-number">5.2. </span>大数定律<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<p>(弱) 大数定律 ((weak) law of large numbers) 是一组关于 <em>样本均值依概率收敛至总体均值</em> 的定理.</p>
<p>大数定律的基本形式是, 当 <span class="math notranslate nohighlight">\(n\to\infty\)</span> 时, 有</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{n}\sum_{i=1}^{n}(z_{i}-E[z_{i}])\stackrel{p}{\to}0. 
\]</div>
<p>不同版本的大数定律基于不同的矩条件, 也取决于对应随机变量的不同相依性(dependence).</p>
<section id="chebyshev">
<h3><span class="section-number">5.2.1. </span>Chebyshev大数定律<a class="headerlink" href="#chebyshev" title="Permalink to this headline">#</a></h3>
<p>我们从最简单的Chebyshev大数定律入手, 来理解大数定律. Chebyshev大数定律利用了<em>Chebyshev不等式</em>, 其定义如下.</p>
<div class="proof theorem admonition" id="cheb_ineq">
<p class="admonition-title"><span class="caption-number">Theorem 5.1 </span> (Chebyshev不等式)</p>
<section class="theorem-content" id="proof-content">
<p>如果随机变量 <span class="math notranslate nohighlight">\(x\)</span> 的二阶矩存在且有限 <span class="math notranslate nohighlight">\(E\left[x^{2}\right]&lt;\infty\)</span>, 那么对于任意 <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span>, 都有</p>
<div class="math notranslate nohighlight">
\[
P\left\{ \left|x\right|&gt;\varepsilon\right\} \leq \frac{E\left[x^{2}\right]}{\varepsilon^{2}}. 
\]</div>
</section>
</div><div class="exercise admonition" id="exercise51">

<p class="admonition-title"><span class="caption-number">Exercise 5.1 </span></p>
<section id="exercise-content">
<p>证明：若 <span class="math notranslate nohighlight">\(r_{2}\geq r_{1}\geq1\)</span>, 则由 <span class="math notranslate nohighlight">\(E\left[\left|x\right|^{r_{2}}\right]&lt;\infty\)</span> 可推断出 <span class="math notranslate nohighlight">\(E\left[\left|x\right|^{r_{1}}\right]&lt;\infty\)</span>. (提示：使用 Holder’s 不等式. )</p>
</section>
</div>
<p>其实, Chebyshev不等式是 <em>Markov不等式</em> 的一种特殊情况.</p>
<div class="proof theorem admonition" id="markov_ineq">
<p class="admonition-title"><span class="caption-number">Theorem 5.2 </span> (Markov不等式)</p>
<section class="theorem-content" id="proof-content">
<p>如果随机变量 <span class="math notranslate nohighlight">\(x\)</span> 的 <span class="math notranslate nohighlight">\(r\)</span> 阶矩 (<span class="math notranslate nohighlight">\(r\ge1\)</span>) 存在且有限 <span class="math notranslate nohighlight">\(E\left[\left|x\right|^{r}\right]&lt;\infty\)</span>, 则对于任意 <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span>, 都有</p>
<div class="math notranslate nohighlight">
\[
P\left\{ \left|x\right|&gt;\varepsilon\right\} \leq \frac{E\left[\left|x\right|^{r}\right]}{\varepsilon^{r}}. 
\]</div>
</section>
</div><p>Markov不等式的证明十分简单.</p>
<div class="proof admonition" id="proof">
<p>Proof. 注意到</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}E\left[\left|x\right|^{r}\right] &amp; =\int_{\left|x\right|&gt;\varepsilon}\left|x\right|^{r}dF_{X}+\int_{\left|x\right|\leq\varepsilon}\left|x\right|^{r}dF_{X}\\
 &amp; \geq\int_{\left|x\right|&gt;\varepsilon}\left|x\right|^{r}dF_{X}\\
 &amp; \geq\varepsilon^{r}\int_{\left|x\right|&gt;\varepsilon}dF_{X}=\varepsilon^{r}P\left\{ \left|x\right|&gt;\varepsilon\right\} , 
\end{aligned}
\end{split}\]</div>
<p>重新排列此不等式, 即可得到Markov不等式.</p>
</div>
<p>接下来我们推导Chebyshev大数定律.</p>
<p>假设 <em>部分和 (partial sum)</em> <span class="math notranslate nohighlight">\(S_{n}=\sum_{i=1}^{n}x_{i}\)</span>, 同时记 <span class="math notranslate nohighlight">\(\mu_{i}=E\left[x_{i}\right]\)</span>, <span class="math notranslate nohighlight">\(\sigma_{i}^{2}=\mathrm{var}\left[x_{i}\right]\)</span>.</p>
<p>对样本均值 <span class="math notranslate nohighlight">\(z_{n}=\overline{x}-\bar{\mu}=n^{-1}\left(S_{n}-E\left[S_{n}\right]\right)\)</span> 运用 Chebyshev 不等式, 得到</p>
<div class="math notranslate nohighlight" id="equation-eqn-cheb-mean">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-eqn-cheb-mean" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
P\left\{ \left|z_{n}\right|\geq\varepsilon\right\}  &amp; =P\left\{ n^{-1}\left|S_{n}-E\left[S_{n}\right]\right|\geq\varepsilon\right\} \\
 &amp; \leq E\left[\left(n^{-1}\sum_{i=1}^{n}\left(x_{i}-\mu_{i}\right)\right)^{2}\right]/\varepsilon^{2}\\
 &amp; =\left(n\varepsilon\right)^{-2}\left\{ E\left[\sum_{i=1}^{n}\left(x_{i}-\mu_{i}\right)^{2}\right]+\sum_{i=1}^{n}\sum_{j\neq i}E\left[\left(x_{i}-\mu_{i}\right)\left(x_{j}-\mu_{j}\right)\right]\right\} \\
 &amp; =\left(n\varepsilon\right)^{-2}\left\{ \sum_{i=1}^{n}\mathrm{var}\left(x_{i}\right)+\sum_{i=1}^{n}\sum_{j\neq i}\mathrm{cov}\left(x_{i}, x_{j}\right)\right\}. 
 \end{aligned}
\end{split}\]</div>
<p>如果在 <span class="math notranslate nohighlight">\(n\to\infty\)</span> 时, 右式趋近于0, 那么 <span class="math notranslate nohighlight">\(z_{n}\)</span> 依概率收敛至0. 比如, 若 <span class="math notranslate nohighlight">\(x_{1}, \ldots, x_{n}\)</span> 是 iid 变量, <span class="math notranslate nohighlight">\(\mathrm{var}\left(x_{1}\right)=\sigma^{2}\)</span>, 那么 <a class="reference internal" href="#equation-eqn-cheb-mean">(5.1)</a> 右式 <span class="math notranslate nohighlight">\(\left(n\varepsilon\right)^{-2}\left(n\sigma^{2}\right)=O \left(n^{-1}\right)\to0\)</span>.</p>
<p>至此, 我们已经得到了Chebyshev大数定律.</p>
<div class="proof theorem admonition" id="cheb_lln">
<p class="admonition-title"><span class="caption-number">Theorem 5.3 </span> (Chebyshev大数定律)</p>
<section class="theorem-content" id="proof-content">
<p>如果 <span class="math notranslate nohighlight">\(\left(z_{1}, \ldots, z_{n}\right)\)</span> 是独立同分布 (iid) 的随机样本, <span class="math notranslate nohighlight">\(E\left[z_{1}\right]=\mu\)</span>, <span class="math notranslate nohighlight">\(\sigma^{2}=\mathrm{var}\left[z_{1}\right]&lt;\infty\)</span> 存在, 则</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{n}\sum_{i=1}^{n}z_{i}\stackrel{p}{\to}\mu. 
\]</div>
</section>
</div><p>事实上, 依概率收敛的大数定律可以去除独立同分布 (iid) 的假设; 样本中的随机变量可以来自不同的分布, 也不必相互独立.</p>
<div class="exercise admonition" id="exercise52">

<p class="admonition-title"><span class="caption-number">Exercise 5.2 </span></p>
<section id="exercise-content">
<p>考虑一组相互独立 (不一定同分布) 的随机样本 <span class="math notranslate nohighlight">\(\left(x_{1}, \ldots, x_{n}\right)\)</span> 使得 <span class="math notranslate nohighlight">\(E\left[x_{i}\right]=0\)</span>, <span class="math notranslate nohighlight">\(\mathrm{var}\left[x_{i}\right]=\sqrt{n}c\)</span>, <span class="math notranslate nohighlight">\(c&gt;0\)</span>是常数. 利用 Chebyshev 不等式, 证明 <span class="math notranslate nohighlight">\(n^{-1}\sum_{i=1}^{n}x_{i}\stackrel{p}{\to}0\)</span>.</p>
</section>
</div>
</section>
<section id="kolmogorov">
<h3><span class="section-number">5.2.2. </span>Kolmogorov大数定律<a class="headerlink" href="#kolmogorov" title="Permalink to this headline">#</a></h3>
<p>大数定律的另一个常见版本是<em>Kolmogorov大数定律</em>. 要导出 Kolmogorov大数定律, 需要更高阶的概率论知识, 因此我们只在此给出结果, 略去证明.</p>
<div class="proof theorem admonition" id="kolm_lln">
<p class="admonition-title"><span class="caption-number">Theorem 5.4 </span> (Kolmogorov LLN)</p>
<section class="theorem-content" id="proof-content">
<p>如果 <span class="math notranslate nohighlight">\(\left(z_{1}, \ldots, z_{n}\right)\)</span> 是独立同分布 (iid) 的随机样本, <span class="math notranslate nohighlight">\(E\left[z_{1}\right]=\mu\)</span> 存在, 那么</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{n}\sum_{i=1}^{n}z_{i}\stackrel{p}{\to}\mu. 
\]</div>
</section>
</div><p>与 Chebyshev大数定律相比, Kolmogorov大数定律只要求总体均值是存在的, 并不对更高阶的矩作要求. 独立同分布的假设对于Kolmogorov大数定律来说已然足够.</p>
<div class="proof example admonition" id="in_dist">
<p class="admonition-title"><span class="caption-number">Example 5.4 </span></p>
<section class="example-content" id="proof-content">
<p>考虑三种分布, 标准正态分布 <span class="math notranslate nohighlight">\(N\left(0, 1\right)\)</span>, <span class="math notranslate nohighlight">\(t\)</span>-分布 <span class="math notranslate nohighlight">\(t\left(2\right)\)</span> (均值为0, 方差无限大) , 柯西分布 (所有的矩都不存在) . 在不同样本容量 <span class="math notranslate nohighlight">\(n=2^{1}, 2^{2}, \ldots, 2^{20}\)</span> 的假设下, 绘制出样本均值的轨迹图. 我们发现, <span class="math notranslate nohighlight">\(N\left(0, 1\right)\)</span> 与 <span class="math notranslate nohighlight">\(t\left(2\right)\)</span> 的样本均值收敛, 而柯西分布的样本均值并不收敛.</p>
</section>
</div><p>[need translation]</p>
<p>This script demonstrates the law of large numbers (LLN) along with the underlying assumptions.</p>
<p>Write a function to generate the sample mean given the sample size <span class="math notranslate nohighlight">\(n\)</span> and the distribution.
We allow three distributions, namely, <span class="math notranslate nohighlight">\(N(0,1)\)</span>, <span class="math notranslate nohighlight">\(t(2)\)</span> and Cauchy.</p>
<p>The sample size is chosen as <span class="math notranslate nohighlight">\(2^x\)</span>, where <span class="math notranslate nohighlight">\(x=1:20\)</span>. We have the following observations.</p>
<ul class="simple">
<li><p>When the distribution is <span class="math notranslate nohighlight">\(N(0,1)\)</span>, the Chebyshev LLN works. The sample mean converges fast.</p></li>
<li><p>When the distribution is <span class="math notranslate nohighlight">\(t(2)\)</span>, which has zero mean but infinite variance, the Kolmogorov LLN works. The sample mean still converges, though more slowly than the <span class="math notranslate nohighlight">\(N(0,1)\)</span> case.</p></li>
<li><p>The Cauchy distribution has no moment at any order. The sample mean does not converge no matter how large is the sample size.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sample.mean</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">distribution</span> <span class="p">){</span>
  <span class="c1"># get sample mean for a given distribution</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">distribution</span> <span class="o">==</span> <span class="s">&quot;normal&quot;</span><span class="p">){</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span> <span class="n">n</span> <span class="p">)</span> <span class="p">}</span> 
  <span class="n">else</span> <span class="nf">if </span><span class="p">(</span><span class="n">distribution</span> <span class="o">==</span> <span class="s">&quot;t2&quot;</span><span class="p">)</span> <span class="p">{</span><span class="n">y</span> <span class="o">=</span> <span class="nf">rt</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">else</span> <span class="nf">if </span><span class="p">(</span><span class="n">distribution</span> <span class="o">==</span> <span class="s">&quot;cauchy&quot;</span><span class="p">)</span> <span class="p">{</span><span class="n">y</span> <span class="o">=</span> <span class="nf">rcauchy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">}</span>
  <span class="nf">return</span><span class="p">(</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>This function plots the sample mean over the path of geometrically increasing sample size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">LLN.plot</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">distribution</span><span class="p">){</span>
  <span class="c1"># draw the sample mean graph</span>
  <span class="n">ybar</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">NN</span><span class="p">),</span> <span class="m">3</span> <span class="p">)</span>
  <span class="nf">for </span><span class="p">(</span><span class="n">rr</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">){</span>
    <span class="nf">for </span><span class="p">(</span> <span class="n">ii</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">NN</span><span class="p">)){</span>
      <span class="n">n</span> <span class="o">=</span> <span class="n">NN</span><span class="p">[</span><span class="n">ii</span><span class="p">];</span> <span class="n">ybar</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">rr</span><span class="p">]</span> <span class="o">=</span> <span class="nf">sample.mean</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
    <span class="p">}</span>  
  <span class="p">}</span>
  <span class="nf">matplot</span><span class="p">(</span><span class="n">ybar</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&quot;l&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;mean&quot;</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> 
       <span class="n">lwd</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="n">distribution</span><span class="p">)</span>
  <span class="nf">abline</span><span class="p">(</span><span class="n">h</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
  <span class="nf">return</span><span class="p">(</span><span class="n">ybar</span><span class="p">)</span>
<span class="p">}</span>
<span class="c1"># calculation</span>
<span class="n">NN</span> <span class="o">=</span> <span class="m">2</span><span class="o">^</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">);</span> <span class="nf">set.seed</span><span class="p">(</span><span class="m">2020-10-7</span><span class="p">);</span> <span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
<span class="n">l1</span> <span class="o">=</span> <span class="nf">LLN.plot</span><span class="p">(</span><span class="s">&quot;normal&quot;</span><span class="p">);</span> <span class="n">l2</span> <span class="o">=</span> <span class="nf">LLN.plot</span><span class="p">(</span><span class="s">&quot;t2&quot;</span><span class="p">);</span> <span class="n">l3</span> <span class="o">=</span> <span class="nf">LLN.plot</span><span class="p">(</span><span class="s">&quot;cauchy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id4">
<h2><span class="section-number">5.3. </span>中心极限定理<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h2>
<p>中心极限定理 (central limit theorem) 是一组关于某随机变量序列 <em>依分布收敛至某稳定分布</em> 的定理. 极限分布通常是正态分布.</p>
<div class="proof theorem admonition" id="clt">
<p class="admonition-title"><span class="caption-number">Theorem 5.5 </span> (中心极限定理)</p>
<section class="theorem-content" id="proof-content">
<p><em>在适当条件下</em>, 对于均值为0的随机样本 <span class="math notranslate nohighlight">\(\left(z_{1}, \ldots, z_{n}\right)\)</span>, 当 <span class="math notranslate nohighlight">\(n\to\infty\)</span> 时,</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{\sqrt{n}}\sum_{i=1}^{n}z_{i}\stackrel{d}{\to}N\left(0, \sigma^{2}\right). 
\]</div>
</section>
</div><p>不同版本的中心极限定理基于对随机变量的不同假设. 其中, <em>Lindeberg-Levy 中心极限定理</em> 最为简单.</p>
<div class="proof theorem admonition" id="ll-clt">
<p class="admonition-title"><span class="caption-number">Theorem 5.6 </span> (Lindeberg-Levy CLT)</p>
<section class="theorem-content" id="proof-content">
<p>假设 <span class="math notranslate nohighlight">\(\left(x_{1}, \ldots, x_{n}\right)\)</span> 是独立同分布的样本, <span class="math notranslate nohighlight">\(E\left[x_{1}\right]=0\)</span>, <span class="math notranslate nohighlight">\(\mathrm{var}\left[x_{1}\right]=\sigma^{2}&lt;\infty\)</span>, 那么</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{\sqrt{n}}\sum_{i=1}^{n}x_{i}\stackrel{d}{\to}N\left(0, \sigma^{2}\right). 
\]</div>
</section>
</div><p>Lindeberg-Levy 中心极限定理的证明依赖于 <em>矩母函数 (MGF, moment generating function)</em>.</p>
<div class="proof definition admonition" id="mgf">
<p class="admonition-title"><span class="caption-number">Definition 5.5 </span> (矩生成函数 MGF)</p>
<section class="definition-content" id="proof-content">
<p>随机变量 <span class="math notranslate nohighlight">\(x\)</span> 的矩生成函数定义为：</p>
<div class="math notranslate nohighlight">
\[
M_{x}\left(t\right)=E\left[\exp\left(xt\right)\right], 
\]</div>
<p>前提是这个期望值存在.</p>
</section>
</div><p>与概率密度函数和累积分布函数一样, 矩母函数也可以完全刻画了一个分布. 例如, 正态分布 <span class="math notranslate nohighlight">\(N\left(\mu, \sigma^{2}\right)\)</span> 的矩母函数是 <span class="math notranslate nohighlight">\(\exp\left(\mu t+\frac{1}{2}\sigma^{2}t^{2}\right)\)</span>.</p>
<div class="proof admonition" id="proof">
<p>Proof. 如果对于任意正整数 <span class="math notranslate nohighlight">\(k\)</span>, 都有 <span class="math notranslate nohighlight">\(E\left[\left|x\right|^{k}\right]&lt;\infty\)</span>, 那么</p>
<div class="math notranslate nohighlight">
\[
M_{X}\left(t\right)=1+tE\left[X\right]+\frac{t^{2}}{2}E\left[X^{2}\right]+\ldots\frac{t}{k!}E\left[X^{k}\right]+O\left(t^{k+1}\right). 
\]</div>
<p>在 <a class="reference internal" href="#ll-clt">Lindeberg-Levy CLT</a> 的假设下, 对于任意 <span class="math notranslate nohighlight">\(i\)</span>, 都有</p>
<div class="math notranslate nohighlight">
\[
M_{\frac{X_{i}}{\sqrt{n}}}\left(t\right)=1+\frac{t^{2}}{2n}\sigma^{2}+O\left(\frac{t^{3}}{n^{3/2}}\right). 
\]</div>
<p>根据独立性,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
M_{\frac{1}{\sqrt{n}}\sum_{i=1}^{n}x_{i}}\left(t\right) &amp; =\prod_{i=1}^{n}M_{\frac{X_{i}}{\sqrt{n}}}\left(t\right)=\left(1+\frac{t^{2}}{2n}\sigma^{2}+O\left(\frac{t^{3}}{n^{3/2}}\right)\right)^{n}\\
 &amp; \to\exp\left(\frac{\sigma^{2}}{2}t^{2}\right). 
\end{aligned}
\end{split}\]</div>
<p>右式的极限分布恰为正态分布的 <span class="math notranslate nohighlight">\(N\left(0, \sigma^{2}\right)\)</span> 的矩母函数.</p>
</div>
<div class="proof remark admonition" id="remark51">
<p class="admonition-title"><span class="caption-number">Remark 5.2 </span></p>
<section class="remark-content" id="proof-content">
<p>上述依赖于 MGF 的证明非常易于理解, 但缺点在于, 并非所有分布都有定义良好的矩母函数. 更一般的证明过程是把矩母函数替换为 <em>特征函数(characteristic function)</em> <span class="math notranslate nohighlight">\(\varphi_{x}\left(t\right)=E\left[\exp\left(\mathrm{i}xt\right)\right]\)</span>, 其中 “<span class="math notranslate nohighlight">\(\mathrm{i}\)</span>” 是虚数单位. 特征函数是概率测度的 <em>傅立叶变换</em> , 它必然存在. 用这种方法来证明中心极限定理, 需要傅立叶变换与逆转换的知识, 我们在这里不做要求.</p>
</section>
</div><p>我们继续介绍中心极限定理的两种常见形式.</p>
<div class="proof theorem admonition" id="lf-clt">
<p class="admonition-title"><span class="caption-number">Theorem 5.7 </span> (Lindeberg-Feller中心极限定理)</p>
<section class="theorem-content" id="proof-content">
<p>假设 <span class="math notranslate nohighlight">\(\left(x_{1}, \ldots, x_{n}\right)\)</span> 是相互独立的样本. 如果满足 <em>Lindeberg condition</em> (对于任意 <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span>,
<span class="math notranslate nohighlight">\(\frac{1}{s_{n}^{2}}\sum_{i=1}^{n}E\left[x_{i}^{2}\cdot\boldsymbol{1}\left\{ \left|x_{i}\right|\geq\varepsilon s_{n}\right\} \right]\to0\)</span>, 其中 <span class="math notranslate nohighlight">\(s_{n}=\sqrt{\sum_{i=1}^{n}\sigma_{i}^{2}}\)</span>) , 那么</p>
<div class="math notranslate nohighlight">
\[
\frac{\sum_{i=1}^{n}x_{i}}{s_{n}}\stackrel{d}{\to}N\left(0, 1\right). 
\]</div>
</section>
</div><div class="proof theorem admonition" id="lya-clt">
<p class="admonition-title"><span class="caption-number">Theorem 5.8 </span> (Lyapunov中心极限定理)</p>
<section class="theorem-content" id="proof-content">
<p>假设 <span class="math notranslate nohighlight">\(\left(x_{1}, \ldots, x_{n}\right)\)</span> 是相互独立的样本. 如果 <span class="math notranslate nohighlight">\(\max_{i\leq n}E\left[\left|x_{i}\right|^{3}\right]&lt;C&lt;\infty\)</span>, 那么有</p>
<div class="math notranslate nohighlight">
\[
\frac{\sum_{i=1}^{n}x_{i}}{s_{n}}\stackrel{d}{\to}N\left(0, 1\right). 
\]</div>
</section>
</div><p>下面是一个模拟案例.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Z_fun</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">distribution</span><span class="p">){</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">distribution</span> <span class="o">==</span> <span class="s">&quot;normal&quot;</span><span class="p">){</span>
      <span class="n">z</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="nf">mean</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
	<span class="p">}</span> <span class="n">else</span> <span class="nf">if </span><span class="p">(</span><span class="n">distribution</span> <span class="o">==</span> <span class="s">&quot;chisq2&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">df</span> <span class="o">=</span> <span class="m">2</span><span class="p">;</span> 
      <span class="n">x</span> <span class="o">=</span> <span class="nf">rchisq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="m">2</span><span class="p">)</span>
      <span class="n">z</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">df</span> <span class="p">)</span> <span class="o">/</span> <span class="nf">sqrt</span><span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="n">df</span><span class="p">)</span>
      <span class="p">}</span>
  <span class="nf">return </span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">CLT_plot</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">distribution</span><span class="p">){</span>
  <span class="n">Rep</span> <span class="o">=</span> <span class="m">10000</span>
  <span class="n">ZZ</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">Rep</span><span class="p">)</span>
  <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">Rep</span><span class="p">)</span> <span class="p">{</span><span class="n">ZZ</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nf">Z_fun</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)}</span>

  <span class="n">xbase</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">-4.0</span><span class="p">,</span> <span class="m">4.0</span><span class="p">,</span> <span class="n">length.out</span> <span class="o">=</span> <span class="m">100</span><span class="p">)</span>
  <span class="nf">hist</span><span class="p">(</span> <span class="n">ZZ</span><span class="p">,</span> <span class="n">breaks</span> <span class="o">=</span> <span class="m">100</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> 
    <span class="n">xlim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span> <span class="nf">min</span><span class="p">(</span><span class="n">xbase</span><span class="p">),</span> <span class="nf">max</span><span class="p">(</span><span class="n">xbase</span><span class="p">)</span> <span class="p">),</span>
    <span class="n">main</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;hist with sample size &quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="p">)</span>
  <span class="nf">lines</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">xbase</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">dnorm</span><span class="p">(</span><span class="n">xbase</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">)</span>
  <span class="nf">return </span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
<span class="n">phist</span> <span class="o">=</span> <span class="nf">CLT_plot</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="s">&quot;chisq2&quot;</span><span class="p">)</span>
<span class="n">phist</span> <span class="o">=</span> <span class="nf">CLT_plot</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="s">&quot;chisq2&quot;</span><span class="p">)</span>
<span class="n">phist</span> <span class="o">=</span> <span class="nf">CLT_plot</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="s">&quot;chisq2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2><span class="section-number">5.4. </span>转化方法<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h2>
<p>大数定律关注样本均值, 而中心极限定理则聚焦于放大后 (乘以 <span class="math notranslate nohighlight">\(\sqrt{n}\)</span> ) 或标准化以后 (除以样本标准差) 的样本均值. 大多数计量经济学的估计量不只是样本均值而已. 比如, 最小二乘估计量</p>
<div class="math notranslate nohighlight">
\[
\widehat{\beta}=\left(\frac{1}{n}\sum_{i}x_{i}x_{i}'\right)^{-1}\frac{1}{n}\sum_{i}x_{i}y_{i}
\]</div>
<p>涉及矩阵求逆和矩阵-向量乘法. 在此, 我们需要一些转化收敛结果的工具.</p>
<div class="proof theorem admonition" id="cmp1">
<p class="admonition-title"><span class="caption-number">Theorem 5.9 </span> (连续映射定理 Continuous mapping theorem 1)</p>
<section class="theorem-content" id="proof-content">
<p>如果 <span class="math notranslate nohighlight">\(x_{n}\stackrel{p}{\to}a\)</span>, 并且 <span class="math notranslate nohighlight">\(f\left(\cdot\right)\)</span> 在 <span class="math notranslate nohighlight">\(a\)</span> 处连续, 那么 <span class="math notranslate nohighlight">\(f\left(x_{n}\right)\stackrel{p}{\to}f\left(a\right)\)</span>.</p>
</section>
</div><div class="proof theorem admonition" id="cmp2">
<p class="admonition-title"><span class="caption-number">Theorem 5.10 </span> (连续映射定理 Continuous mapping theorem 2)</p>
<section class="theorem-content" id="proof-content">
<p>如果 <span class="math notranslate nohighlight">\(x_{n}\stackrel{p}{\to}a\)</span>, 并且 <span class="math notranslate nohighlight">\(f\left(\cdot\right)\)</span> 在 <span class="math notranslate nohighlight">\(x\)</span> 的支撑集上 <em>几乎处处</em> 连续, 那么 <span class="math notranslate nohighlight">\(f\left(x_{n}\right)\stackrel{d}{\to}f\left(x\right)\)</span>.</p>
</section>
</div><div class="proof theorem admonition" id="slutsky">
<p class="admonition-title"><span class="caption-number">Theorem 5.11 </span> (Slutsky’s theorem)</p>
<section class="theorem-content" id="proof-content">
<p>假设 <span class="math notranslate nohighlight">\(x_{n}\stackrel{d}{\to}x\)</span>, <span class="math notranslate nohighlight">\(y_{n}\stackrel{p}{\to}a\)</span>, 那么</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_{n}+y_{n}\stackrel{d}{\to}x+a\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(x_{n}y_{n}\stackrel{d}{\to}ax\)</span>;</p></li>
<li><p>若 <span class="math notranslate nohighlight">\(a\neq0\)</span>, 则 <span class="math notranslate nohighlight">\(x_{n}/y_{n}\stackrel{d}{\to}x/a\)</span>.</p></li>
</ul>
</section>
</div><p><a class="reference internal" href="#slutsky">Slutsky’s theorem</a> 只是 <a class="reference internal" href="#cmp2">Continuous mapping theorem 2</a> 的特殊情况. 由于加法、乘法、除法是现实中最常用的运算, 故将单列为定理.</p>
<div class="proof theorem admonition" id="delta">
<p class="admonition-title"><span class="caption-number">Theorem 5.12 </span> (Delta method)</p>
<section class="theorem-content" id="proof-content">
<p>假设 <span class="math notranslate nohighlight">\(\sqrt{n}\left(\widehat{\theta}-\theta_{0}\right)\stackrel{d}{\to}N\left(0, \Omega\right)\)</span>, 并且 <span class="math notranslate nohighlight">\(f\left(\cdot\right)\)</span> 在 <span class="math notranslate nohighlight">\(\theta_{0}\)</span> 处连续可微 (即 <span class="math notranslate nohighlight">\(\frac{\partial}{\partial\theta}f\left(\cdot\right)\)</span> 在 <span class="math notranslate nohighlight">\(\theta_{0}\)</span> 处连续) , 那么</p>
<div class="math notranslate nohighlight">
\[
\sqrt{n}\left(f\left(\widehat{\theta}\right)-f\left(\theta_{0}\right)\right)\stackrel{d}{\to}N\left(0, \frac{\partial f}{\partial\theta'}\left(\theta_{0}\right)\Omega\left(\frac{\partial f}{\partial\theta}\left(\theta_{0}\right)\right)'\right). 
\]</div>
<div class="proof admonition" id="proof">
<p>Proof. 在 <span class="math notranslate nohighlight">\(\theta_{0}\)</span> 处取泰勒展开式 <span class="math notranslate nohighlight">\(f\left(\widehat{\theta}\right)\)</span>, 得</p>
<div class="math notranslate nohighlight">
\[
f\left(\widehat{\theta}\right)-f\left(\theta_{0}\right)=\frac{\partial f\left(\dot{\theta}\right)}{\partial\theta'}\left(\widehat{\theta}-\theta_{0}\right), 
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\dot{\theta}\)</span> 位于 <span class="math notranslate nohighlight">\(\widehat{\theta}\)</span> 与 <span class="math notranslate nohighlight">\(\theta_{0}\)</span> 之间的线段上.</p>
<p>等式两边同时乘以 <span class="math notranslate nohighlight">\(\sqrt{n}\)</span>, 得到</p>
<div class="math notranslate nohighlight">
\[
\sqrt{n}\left(f\left(\widehat{\theta}\right)-f\left(\theta_{0}\right)\right)=\frac{\partial f\left(\dot{\theta}\right)}{\partial\theta'}\sqrt{n}\left(\widehat{\theta}-\theta_{0}\right). 
\]</div>
<p>因为可以由 <span class="math notranslate nohighlight">\(\widehat{\theta}\stackrel{p}{\to}\theta_{0}\)</span> 推导出 <span class="math notranslate nohighlight">\(\dot{\theta}\stackrel{p}{\to}\theta_{0}\)</span>, 并且 <span class="math notranslate nohighlight">\(\frac{\partial}{\partial\theta'}f\left(\cdot\right)\)</span> 在 <span class="math notranslate nohighlight">\(\theta_{0}\)</span> 处连续, 所以根据 <a class="reference internal" href="#cmp1">Continuous mapping theorem 1</a>, 有 <span class="math notranslate nohighlight">\(\frac{\partial}{\partial\theta'}f\left(\dot{\theta}\right)\stackrel{p}{\to}\frac{\partial f\left(\theta_{0}\right)}{\partial\theta'}\)</span>.</p>
<p>另一方面, 由于 <span class="math notranslate nohighlight">\(\sqrt{n}\left(\widehat{\theta}-\theta_{0}\right)\stackrel{d}{\to}N\left(0, \Omega\right)\)</span>, 根据 <a class="reference internal" href="#slutsky">Slutsky’s theorem</a>可得</p>
<div class="math notranslate nohighlight">
\[
\sqrt{n}\left(f\left(\widehat{\theta}\right)-f\left(\theta_{0}\right)\right)\stackrel{d}{\to}\frac{\partial f\left(\theta_{0}\right)}{\partial\theta'}N\left(0, \Omega\right). 
\]</div>
<p>证明完毕.</p>
</div>
</section>
</div></section>
<section id="id6">
<h2><span class="section-number">5.5. </span>总结<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h2>
<p>渐进理论是一个既广且深的课题. 在本章中, 我们只涉猎其表. 我们将在下一章继续探讨如何将渐进理论应用于最小二乘法.</p>
<div class="admonition- admonition">
<p class="admonition-title">历史趣闻</p>
<p>在20世纪80年代之前, 大多数计量经济学家都没有受过严谨的数学训练, 因此无法很好地掌握渐进理论. 几位当时年轻的计量经济学家拓展了渐进理论在计量经济学中的疆域, 深刻地改变了计量经济学面貌. 其中的佼佼者有 Halbert White (UCSD), Peter C. B.  Phillips (Yale), 以及 Peter Robinson (LSE).</p>
</div>
<p>[need to add citations]</p>
<div class="admonition- admonition">
<p class="admonition-title">拓展阅读</p>
<p>Halbert White (1950-2012) 写过一本相对易读易懂的教科书 (White, 2000, first edition 1984) 向计量经济学家介绍渐进理论. 时至今日, 这本书在经济学研究者和研究生中仍然很受欢迎. 另外, Davidson (1994) 是一本更详细、自成一体的专著.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="lecture4-CN.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4. </span>最小二乘法: 有限样本理论</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="lecture8-CN.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>假设检验</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By 史震涛 Shi Zhentao<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>